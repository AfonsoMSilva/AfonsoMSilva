"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[1491],{52204:(e,a,t)=>{t.r(a),t.d(a,{PaymentCardAddPanel:()=>S});var n,i=t(96832),l=t(50756),d=t(14900),o=t(87279),r=t(82598),c=t(91871),_=t(53214),p=t(39431),s=t(86498),m=t(88203),u=t(45272),y=t(92077),b=t(76376),h=t(6697),C=t(19122),w=t(12271),g=t(61290),f=t(77257),v=t(63520),N=t(44110);const x="_common_generic_error",S=()=>{const[e,a]=(0,i.useState)(!1),[t,S]=(0,i.useState)(!1),{translate:Z}=(0,m.Z)(),{routes:I}=(0,b.Xo)(),{showAlert:V}=(0,s.V)(),{createVaultItem:k}=(0,r.u)(c.L),{currentSpaceId:E}=(0,C.fV)(),[R,B]=(0,i.useState)(),[X,O]=(0,i.useState)({itemName:"",cardNumber:"",ownerName:"",securityCode:"",expireMonth:"",expireYear:"",color:_.X.Blue1,spaceId:null!=E?E:"",note:""}),{openDialog:P,shouldShowFrozenStateDialog:L}=(0,h.Ub)();(0,i.useEffect)((()=>{(0,u.Nc)(l.PageView.ItemCreditCardCreate)}),[]),(0,i.useEffect)((()=>{L&&P()}),[L]);const $=()=>{(0,u.Nc)(l.PageView.ItemPaymentList),(0,y.uX)(I.userPayments)};return(0,N.tZ)(v.zI,{isUsingNewDesign:!0,isViewingExistingItem:!1,itemHasBeenEdited:e,onNavigateOut:$,submitPending:t,onSubmit:async()=>{if(t)return;const e=(0,w.u)(X);if(!e.isValid)return B(e.errorSet);S(!0);try{const e=await k({vaultItemType:p.U.PaymentCard,content:X});(0,o.d6)(e)?(V(X.itemName?Z("webapp_payment_edition_name_save_alert",{paymentCard:X.itemName}):Z("webapp_payment_edition_generic_save_alert"),d.BLW.SUCCESS),$()):(V(Z(x),d.BLW.ERROR),S(!1))}catch(e){V(Z(x),d.BLW.ERROR),S(!1)}},formId:"add_paymentcard_panel",header:(0,N.tZ)(v.V9,{icon:n||(n=(0,N.tZ)(g.Z,{iconSize:"large"})),iconBackgroundColor:(0,f.Z)(X.color),title:Z("webapp_payment_edition_header_add_payment_card")}),children:(0,N.tZ)(w.gd,{paymentCardContent:X,onValueChanged:e=>{O((a=>({...a,...e}))),a(!0)},errors:R})})}},12271:(e,a,t)=>{t.d(a,{gd:()=>V,u:()=>k});var n=t(96832),i=t(53214),l=t(50756),d=t(78971),o=t(88203),r=t(45272),c=t(6697),_=t(82207),p=t(30894),s=t(68819),m=t(67406),u=t(68037),y=t(7973),b=t(711),h=t(44110);const C=(([e,a],t="ASC")=>{const n=(new Date).getFullYear()+e,i=Math.abs(a-e)+1,l=new Array(i).fill(null).map(((e,a)=>({label:(n+a).toString(),value:n+a})));return"ASC"===t?l:l.sort((({value:e},{value:a})=>a-e))})([0,30],"ASC"),w=new Array(12).fill(null).map(((e,a)=>(0,y.Z)((0,b.Z)(new Date,a),"MM"))).map((e=>(0,h.tZ)(d.$m,{value:e,children:e},e))),g=C.map((e=>(0,h.tZ)(d.$m,{value:JSON.stringify(e.value),children:e.label},e.value))),f=({month:e,year:a,disabled:t,onYearChange:n,onMonthChange:i})=>{const{translate:l}=(0,o.Z)();return(0,h.BX)(d.kC,{gap:"8px",children:[(0,h.tZ)(d.mg,{"data-name":"card-expiration-month",label:l("webapp_field_expiry_date_month"),value:e,onChange:e=>{i(e)},readOnly:t,sx:{flex:1},children:w}),(0,h.tZ)(d.mg,{"data-name":"card-expiration-year",label:l("webapp_field_expiry_date_year"),value:a,onChange:e=>{n(e)},readOnly:t,sx:{flex:1},children:g})]})};var v=t(62385);const N="webapp_payment_edition_field_card_action_show_note",x="webapp_payment_edition_field_card_action_hide_note",S="webapp_payment_edition_field_cardColor_",Z=e=>a=>{a&&(0,r.Kz)(new l.UserCopyVaultItemFieldEvent({itemType:l.ItemType.CreditCard,field:e,itemId:a,isProtected:!0}))},I={[i.X.Black]:`${S}BLACK`,[i.X.Blue1]:`${S}BLUE_1`,[i.X.Blue2]:`${S}BLUE_2`,[i.X.Gold]:`${S}GOLD`,[i.X.Green1]:`${S}GREEN_1`,[i.X.Green2]:`${S}GREEN_2`,[i.X.Orange]:`${S}ORANGE`,[i.X.Red]:`${S}RED`,[i.X.Silver]:`${S}SILVER`,[i.X.White]:`${S}WHITE`},V=({itemId:e,errors:a,paymentCardContent:t,onValueChanged:y,showCopyAlert:b,variant:C})=>{const{cardNumber:w,color:g,expireMonth:S,expireYear:V,itemName:k,note:E,ownerName:R,securityCode:B="",spaceId:X}=t,{translate:O}=(0,o.Z)(),{shouldShowFrozenStateDialog:P}=(0,c.Ub)(),{logRevealCreditCardField:L}=(0,v.E)(),$=Boolean(w.length),A=Boolean(B.length),D=Boolean(E.length),U=(0,n.useCallback)((e=>a=>{const t="string"==typeof a?a:a.target.value,n="cardNumber"===e?t.replaceAll(" ",""):t;y({[e]:n})}),[y]),{areProtectedItemsUnlocked:F,openProtectedItemsUnlocker:M}=(0,p.tY)(),[z,T]=(0,n.useState)(!$),G=(0,n.useCallback)((a=>{e&&(0,r.Kz)(new l.UserRevealVaultItemFieldEvent({field:a,isProtected:!0,itemId:e,itemType:l.ItemType.CreditCard}))}),[e]),Y=(0,n.useCallback)(((e,a)=>new Promise(((t,n)=>{if(e||F)return a(),t();M({action:s.P.Show,itemType:s.R.CreditCard,successCallback:()=>(a(),t()),cancelCallback:n})}))),[F,M]),q=(0,n.useCallback)((()=>{z||(G(l.Field.CardNumber),L({field:"number",name:k})),T((e=>!e))}),[z,G,L,k]),W=!F,K=(a,t)=>{a(e),b&&b(O(t))},[H,j]=(0,n.useState)(""===B),[J,Q]=(0,n.useState)(""===E),ee=(0,n.useCallback)((()=>{H||(G(l.Field.SecurityCode),L({field:"cvv",name:k})),j((e=>!e))}),[H,G,L,k]),ae=()=>Q((e=>!e)),te=Object.values(i.X).map((e=>({label:O(I[e]),value:e}))),ne=$?z?w:"●●●● ●●●● ●●●● ●●●●":"";return(0,h.BX)("div",{sx:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,h.BX)(u.u,{title:O("webapp_payment_edition_content_card_details_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,h.tZ)(d.qo,{"data-name":"ownerName",value:R,label:O("webapp_payment_edition_field_ownerName"),placeholder:O("webapp_payment_edition_field_placeholder_no_ownerName"),onChange:U("ownerName"),disabled:!!P}),(0,h.tZ)(d.Nc,{"data-name":"cardNumber",required:!0,formatter:z?"card":void 0,label:O("webapp_payment_edition_field_cardNumber"),placeholder:O("webapp_payment_edition_field_placeholder_no_cardNumber"),isValueInitiallyVisible:z,toggleVisibilityLabel:{hide:O("webapp_payment_edition_field_card_action_hide_card_number"),show:O("webapp_payment_edition_field_card_action_show_card_number")},onValueVisibilityChangeRequest:()=>Y(z,q),onCopy:e=>{e.preventDefault(),navigator.clipboard.writeText(ne)},readOnly:!z&&$||!!P,value:ne,actions:"edit"===C?[(0,h.tZ)(_.m,{data:w,checkProtected:()=>W,copyLabel:O("webapp_payment_edition_field_card_action_copy_card_number"),onCopy:()=>K(Z(l.Field.CardNumber),"webapp_payment_edition_field_cardNumber_copied")},"copy-card-number")]:void 0,onChange:U("cardNumber"),error:a?.has("cardNumber")},`cardNumber${z}`),(0,h.tZ)(d.Nc,{readOnly:!H&&A||!!P,value:H?B:"●●●",label:O("webapp_payment_edition_field_securityCode"),placeholder:O("webapp_payment_edition_field_placeholder_no_securityCode"),onValueVisibilityChangeRequest:()=>Y(H,ee),isValueInitiallyVisible:H,toggleVisibilityLabel:{hide:O("webapp_payment_edition_field_card_action_hide_security_code"),show:O("webapp_payment_edition_field_card_action_show_security_code")},actions:"edit"===C?[(0,h.tZ)(_.m,{checkProtected:()=>W,data:B,copyLabel:O("webapp_payment_edition_field_card_action_copy_security_code"),onCopy:()=>K(Z(l.Field.CardNumber),"webapp_payment_edition_field_securityCode_copied")},"copy-security-code")]:void 0,onChange:U("securityCode"),error:a?.has("securityCode")},`securityCode${H}`),(0,h.tZ)(f,{month:S,year:V,onYearChange:U("expireYear"),onMonthChange:U("expireMonth")}),(0,h.tZ)(d.Kx,{sx:{"textarea, .readOnlyMask":{variant:"text.ds.body.standard.monospace"}},label:O("webapp_payment_edition_field_notes"),placeholder:O("webapp_payment_edition_field_placeholder_no_notes"),"data-name":"note",readOnly:!J&&D||!!P,value:J||!D?E:"••••",onChange:U("note"),actions:[(0,h.tZ)(d.zx,{layout:"iconOnly",icon:J?"ActionHideOutlined":"ActionRevealOutlined",mood:"brand",intensity:"supershy",sx:{marginRight:"16px"},onClick:()=>{Y(J,ae).catch((()=>{Q(!1)}))},"aria-label":O(J?x:N),tooltip:O(J?x:N)},"card-note-visibility"),..."edit"===C?[(0,h.tZ)(_.m,{data:E,checkProtected:()=>W,copyLabel:O("webapp_payment_edition_field_card_action_copy_note"),onCopy:()=>K(Z(l.Field.Note),"webapp_payment_edition_field_notes_copied"),itemType:s.R.CreditCard,tooltipLocation:"right"},"copy-note")]:[]],"data-testid":"credential_edit_note_value"})]}),(0,h.BX)(u.u,{title:O("webapp_payment_edition_content_card_organization_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,h.tZ)(d.qo,{value:k,label:O("webapp_payment_edition_field_cardname"),placeholder:O("webapp_payment_edition_field_placeholder_no_cardname"),onChange:U("itemName"),disabled:!!P},"cardname"),(0,h.tZ)(d.mg,{label:O("webapp_payment_edition_field_cardColor"),placeholder:O(I[g]),value:g,onChange:U("color"),disabled:!!P,children:te.map((e=>(0,h.tZ)(d.$m,{value:e.value,children:e.label},e.value)))},`cardColor${g}`),(0,h.tZ)(m.M,{isUsingNewDesign:!0,spaceId:null!=X?X:"",labelSx:m.e,onChange:e=>U("spaceId")(e),disabled:!!P})]})]})},k=e=>{const a=new Set;return e.cardNumber&&0!==e.cardNumber.length||a.add("cardNumber"),a.size>0?{isValid:!1,errorSet:a}:{isValid:!0}}}}]);