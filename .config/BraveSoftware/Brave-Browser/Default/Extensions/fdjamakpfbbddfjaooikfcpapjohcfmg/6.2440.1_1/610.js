"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[610],{15400:(e,t,i)=>{i.r(t),i.d(t,{IdCardEditPanel:()=>d,IdGroupTab:()=>l});var a=i(39431),n=i(62428),s=i(29967),o=i(44110);const r={HEADER_DESCRIPTION:"webapp_id_edition_idcard_header_description",DIALOG_DELETE_TITLE:"webapp_id_edition_idcard_dialog_delete_title",ALERT_DELETE:"webapp_id_edition_idcard_alert_delete",ALERT_EDIT:"webapp_id_edition_idcard_alert_edit",COPY_SUCCESS:"webapp_id_copy_success_id_card_number"};let l=function(e){return e[e.DETAILS=0]="DETAILS",e[e.ATTACHMENTS=1]="ATTACHMENTS",e}({});const d=({listRoute:e,id:t,setDialogActive:i,lee:l,hasUnsavedData:d,setHasUnsavedData:c})=>t?(0,o.tZ)(s.y,{listRoute:e,id:`{${t}}`,setDialogActive:i,lee:l,hasUnsavedData:d,setHasUnsavedData:c,ID_TYPE:a.U.IdCard,I18N_KEYS:r,children:({handleCopy:e,values:t})=>(0,o.tZ)(n.P,{variant:"edit",handleCopy:e,country:t.country})}):null},29967:(e,t,i)=>{i.d(t,{y:()=>R});var a=i(96832),n=i(48038),s=i(88203),o=i(66219),r=i(99852),l=i(39431),d=i(91871);const c={[l.U.DriversLicense]:"driversLicensesResult",[l.U.FiscalId]:"fiscalIdsResult",[l.U.IdCard]:"idCardsResult",[l.U.Passport]:"passportsResult",[l.U.SocialSecurityId]:"socialSecurityIdsResult"};var u=i(50756),m=i(92077),_=i(45272),p=i(74910),D=i(82994),h=i(4586),b=i(15400),g=i(55139),T=i(77377);const f=e=>`id-edit-panel-${e}`;var I=i(78971),S=i(87279),C=i(82598),E=i(58363),A=i(44110);const L={backgroundColor:"ds.container.agnostic.neutral.supershy",borderTopWidth:"1px",borderTopStyle:"solid",borderTopColor:"ds.border.neutral.quiet.idle",padding:"16px 24px",gap:"8px"},y=({formId:e,handleCancel:t,handleDelete:i,hasDataBeenModified:a,isSubmitting:n,focusAttachmentTab:o})=>{const{translate:r}=(0,s.Z)();return(0,A.BX)(I.kC,{className:"actions",sx:L,as:"footer",justifyContent:"flex-start",flexWrap:"nowrap",children:[(0,A.tZ)(I.zx,{"aria-label":r("webapp_panel_edition_generic_delete"),onClick:i,mood:"danger",intensity:"supershy",layout:"iconOnly",icon:"ActionDeleteOutlined",disabled:n}),!!o&&(0,A.tZ)(I.zx,{mood:"neutral",intensity:"supershy",onClick:o,layout:"iconLeading",icon:"AttachmentOutlined",children:r("webapp_secure_notes_add_attachment_action_name")},"attach"),a?(0,A.BX)(I.kC,{flexWrap:"nowrap",sx:{marginLeft:"auto"},children:[(0,A.tZ)(I.zx,{type:"submit",form:e,disabled:n,children:r("webapp_panel_edition_generic_save_changes")}),(0,A.tZ)(I.zx,{mood:"neutral",intensity:"quiet",sx:{marginLeft:"16px"},onClick:t,children:r("webapp_panel_edition_generic_cancel_changes")})]}):(0,A.tZ)(I.zx,{onClick:t,mood:"neutral",intensity:"quiet",sx:{marginLeft:"auto"},children:r("webapp_panel_edition_generic_close")})]})};var v=i(55752);const w="id-edit-form",U=({itemId:e,type:t,openConfirmDeleteDialog:i,editAlertTranslation:n,reportError:o,initialValues:r,hasUnsavedData:c,setHasUnsavedData:m,setCurrentCountry:p,copySuccessKey:D,hasTabs:h,focusAttachment:b,children:g,showListView:T})=>{const{translate:f}=(0,s.Z)(),[L,U]=(0,a.useState)(!1),{updateVaultItem:N}=(0,C.u)(d.L),Z=(0,a.useRef)((e=>{if(null!==e){const{dirty:t,isSubmitting:i,values:a}=e;m(t),U(i),p(a.country)}})),{showToast:R}=(0,I.pm)(),P=(i,a)=>{(0,_.Kz)(new u.UserCopyVaultItemFieldEvent({itemType:E.L[t],field:E.H[t],itemId:e,isProtected:!1})),i&&R({description:f(D)}),a&&"function"==typeof o&&o(a,"[id-form] Unable to copy to clipboard")},x=()=>{R({description:f("_common_generic_error"),mood:"danger",isManualDismiss:!0})};return(0,A.BX)(A.HY,{children:[(0,A.tZ)("div",{"aria-labelledby":"tab-ids-detail",id:"content-ids-detail",sx:{display:"flex",flex:"1"},children:(0,A.tZ)(v.P,{formId:w,formRef:Z.current,handleSubmit:async(i,{setSubmitting:a,setFieldError:s})=>{const r=t===l.U.FiscalId?"fiscalNumber":"idNumber";if(!i[r])return s(r,"");try{a(!0);const s=await N({vaultItemType:t,content:i,id:e});(0,S.d6)(s)?(R({description:f(n)}),T()):(a(!1),x(),o(new Error("[ids][edit] Unable to update id"),s.error?.errorMessage))}catch(e){a(!1),x(),o(e,"[ids][edit] Unexpected exception while updating id")}},initialValues:r,variant:"edit",children:e=>g({handleCopy:P,values:e})})}),(0,A.tZ)(y,{formId:w,handleCancel:()=>{T()},handleDelete:i,hasDataBeenModified:c,isSubmitting:L,focusAttachmentTab:h?b:void 0})]})},N=({getDescription:e,title:t,...i})=>{const{translate:n}=(0,s.Z)(),{item:o,initialValues:r,type:d,children:c,showConfirmDelete:I,closeConfirmDeleteDialog:S,deleteDialogTitle:C,deleteAlertTranslation:E,listRoute:L}=i,{hasTabs:y,activeTab:v,tabs:w,focusAttachment:N,cleanActiveTab:Z}=function(e){var t;const i=(0,T.w)(g.w.TechweekWebAttachmentsForIdsV1),n=(0,a.useRef)(null),[o,r]=(0,a.useState)(null!=(t=(e=>{const t=window.sessionStorage.getItem(f(e));return t?parseInt(t,10):null})(e))?t:b.IdGroupTab.DETAILS),l=(0,a.useCallback)((t=>{window.sessionStorage.setItem(f(e),t.toString()),r(t)}),[e]),d=(0,a.useCallback)((()=>{window.sessionStorage.removeItem(f(e))}),[e]),c=(0,a.useCallback)((()=>l(b.IdGroupTab.ATTACHMENTS)),[l]),{translate:u}=(0,s.Z)(),m=(0,a.useMemo)((()=>[{id:"tab-ids-detail",contentId:"content-ids-detail",title:u("webapp_secure_notes_addition_tab_title_details"),onSelect:()=>l(b.IdGroupTab.DETAILS)},{id:"tab-ids-attachments",contentId:"content-ids-attachments",title:u("webapp_secure_notes_edition_field_tab_title_attachments"),onSelect:c}]),[c,u,l]);return(0,a.useEffect)((()=>{const e=e=>{n.current&&!n.current.contains(e.target)&&d()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[d,n]),{editPanelRef:n,hasTabs:i,activeTab:o,tabs:m,focusAttachment:c,cleanActiveTab:d}}(o.id),[R,P]=a.useState(r.country);a.useEffect((()=>{(0,h.w)()}),[]),a.useEffect((()=>{const e={[l.U.DriversLicense]:u.PageView.ItemDriverLicenceDetails,[l.U.FiscalId]:u.PageView.ItemFiscalStatementDetails,[l.U.IdCard]:u.PageView.ItemIdCardDetails,[l.U.Passport]:u.PageView.ItemPassportDetails,[l.U.SocialSecurityId]:u.PageView.ItemSocialSecurityStatementDetails};(0,_.Nc)(e[d])}),[d]);const x=a.useMemo((()=>({confirmDeleteConfirm:n("webapp_id_edition_dialog_delete_confirm"),confirmDeleteDismiss:n("webapp_id_edition_dialog_delete_dismiss"),confirmDeleteSubtitle:n("webapp_id_edition_dialog_delete_subtitle"),confirmDeleteTitle:n(C),deleteSuccessToast:n(E)})),[C,E,n]),O=()=>{Z(),(0,_.Nc)(u.PageView.ItemIdList),(0,m.uX)(L)},B=!y||b.IdGroupTab.DETAILS===v;return(0,A.BX)(A.HY,{children:[(0,A.tZ)(p.h,{country:R,description:e(R),title:t,type:d,tabs:y?w:void 0}),B?(0,A.tZ)(U,{...i,setCurrentCountry:P,hasTabs:y,focusAttachment:N,cleanActiveTab:Z,showListView:O,children:c}):null,(0,A.tZ)(D.s,{isVisible:I,itemId:o.id,closeConfirmDeleteDialog:S,onDeletionSuccess:O,translations:x,vaultItemType:l.U.PaymentCard})]})};function Z(e,t){return e.hasOwnProperty(t)}const R=({ID_TYPE:e,I18N_KEYS:t,listRoute:i,id:l,setDialogActive:u,lee:m,hasUnsavedData:_,setHasUnsavedData:p,children:D})=>{const{translate:h}=(0,s.Z)(),{status:b,item:g}=function(e,t){const{status:i,data:a}=(0,r.k)(d.L,"query",{vaultItemTypes:[e],ids:[t]});return{status:i,item:a?.[c[e]].items[0]}}(e,l),{showConfirmDelete:T,openConfirmDeleteDialog:f,closeConfirmDeleteDialog:I}=function(e){const[t,i]=a.useState(!1);return{showConfirmDelete:t,openConfirmDeleteDialog:()=>{i(!0),e(!0)},closeConfirmDeleteDialog:()=>{i(!1),e(!1)}}}(u);return b===n.rq.Success&&void 0!==g?(0,A.tZ)(N,{itemId:l,item:g,copySuccessKey:t.COPY_SUCCESS,deleteAlertTranslation:t.ALERT_DELETE,deleteDialogTitle:t.DIALOG_DELETE_TITLE,editAlertTranslation:t.ALERT_EDIT,initialValues:g,listRoute:i,reportError:m.reportError,showConfirmDelete:T,openConfirmDeleteDialog:f,closeConfirmDeleteDialog:I,hasUnsavedData:_,setHasUnsavedData:p,type:e,getDescription:e=>(0,o.Il)(h(t.HEADER_DESCRIPTION),h.getLocale(),e),title:(S=g,Z(S,"idName")?S.idName:Z(S,"idNumber")?S.idNumber:S.fiscalNumber),children:D}):null;var S}},72055:(e,t,i)=>{i.d(t,{a:()=>n});var a=i(30309);const n=new Set([a.cH.AU,a.cH.GB,a.cH.IE,a.cH.NZ])},62428:(e,t,i)=>{i.d(t,{P:()=>h});var a=i(96832),n=i(88355),s=i(88203),o=i(49023),r=i(6697),l=i(68037),d=i(72055),c=i(16792),u=i(87773),m=i(82207),_=i(44110);const p={...c.k,DETAILS_CONTENT_LABEL:"webapp_id_form_id_card_content_details_label"},D=({variant:e,handleCopy:t,country:i})=>{const{translate:c}=(0,s.Z)(),{shouldShowFrozenStateDialog:D}=(0,r.Ub)(),{values:h}=(0,n.u6)(),b=a.useRef(null);return a.useEffect("add"===e?()=>{const e=setTimeout((()=>{b.current?.focus()}),o.sc);return()=>clearTimeout(e)}:()=>{},[]),(0,_.BX)(_.HY,{children:[(0,_.BX)(l.u,{title:c(p.DETAILS_CONTENT_LABEL),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,_.tZ)(u.YI,{name:"idName",label:c(p.NAME_LABEL),placeholder:c(p.NAME_PLACEHOLDER),ref:b,disabled:!!D}),(0,_.tZ)(u.YI,{name:"idNumber",label:c(p.ID_NUMBER_LABEL),placeholder:c(p.ID_NUMBER_PLACEHOLDER),actions:"edit"===e?[(0,_.tZ)(m.m,{data:h.idNumber,onCopy:t},"copy")]:void 0,disabled:!!D}),(0,_.tZ)(u.Nn,{name:"issueDate",label:c(p.ISSUE_DATE_LABEL),disabled:!!D,calendarButtonLabel:c(p.ISSUE_DATE_PICK)}),(0,_.tZ)(u.Nn,{name:"expirationDate",label:c(d.a.has(i)?p.EXPIRATION_DATE_LABEL_UK:p.EXPIRATION_DATE_LABEL_US),calendarButtonLabel:c(d.a.has(i)?p.EXPIRATION_DATE_PICK_UK:p.EXPIRATION_DATE_PICK_US),disabled:!!D}),(0,_.tZ)(u.Dz,{name:"country",label:c(p.COUNTRY_LABEL),disabled:!!D})]}),(0,_.tZ)(u.A0,{name:"spaceId",disabled:!!D,wrapInContentCard:!0,contentCardLabel:c(p.ORGANIZATION_CONTENT_LABEL)})]})},h=a.memo(D)},82994:(e,t,i)=>{i.d(t,{s:()=>p}),i(96832);var a=i(78971),n=i(82598),s=i(33354),o=i(91871),r=i(88203);let l=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var d=i(65580),c=i(44110);const u=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:n})=>{const{translate:s}=(0,r.Z)(),o=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:a,collectionSharingTitle:n,genericErrorTitle:s}=e;switch(t){case l.LastAdmin:return a;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,d.U)(t)}})(t,e),u=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:a,collectionSharingSubtitle:n,genericErrorSubtitle:s}=e;switch(t){case l.LastAdmin:return a;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,d.U)(t)}})(t,e);return(0,c.tZ)(a.Vq,{isOpen:!0,onClose:n,title:null!=o?o:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===l.LastAdmin||l.GroupSharing||l.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),n()}}}:void 0,children:u})};var m=i(37527);const _=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:n}=(0,r.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:o,confirmDeleteDismiss:l,confirmDeleteConfirm:d}=i;return(0,c.tZ)(a.Vq,{title:o,onClose:e,isOpen:!0,dialogClassName:m.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:d,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:l,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},p=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:d,onDeletionSuccess:m,sharingStatus:p,translations:D,vaultItemType:h,isShared:b,isSharedViaUserGroup:g,isItemInCollection:T,isLastAdmin:f})=>{const{showToast:I}=(0,a.pm)(),{translate:S}=(0,r.Z)(),{deleteVaultItems:C}=(0,n.u)(o.L);if(!i)return null;let E;return(b||p?.isShared)&&(g&&(E=l.GroupSharing),f&&(E=l.LastAdmin),T&&(E=l.CollectionSharing)),E&&t?(0,c.tZ)(u,{reason:E,translations:D,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,c.tZ)(_,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await C({ids:[d],vaultItemType:h})).tag===s.rq.Success?(I({description:null!=(e=D.deleteSuccessToast)?e:S("webapp_personal_info_edition_delete_success_toast")}),m()):I({description:S("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){I({description:S("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:D})}}}]);