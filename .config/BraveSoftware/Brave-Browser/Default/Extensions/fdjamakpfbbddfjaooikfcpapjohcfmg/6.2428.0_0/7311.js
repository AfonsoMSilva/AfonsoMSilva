"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[7311],{682994:(e,t,i)=>{i.d(t,{s:()=>S}),i(696832);var s=i(659035),n=i(482598),a=i(133354),o=i(970433),r=i(488203);let l=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var c=i(365580),d=i(528835);const u=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:n})=>{const{translate:a}=(0,r.Z)(),o=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:s,collectionSharingTitle:n,genericErrorTitle:a}=e;switch(t){case l.LastAdmin:return s;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return a;default:return(0,c.U)(t)}})(t,e),u=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:s,collectionSharingSubtitle:n,genericErrorSubtitle:a}=e;switch(t){case l.LastAdmin:return s;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return a;default:return(0,c.U)(t)}})(t,e);return(0,d.tZ)(s.Vq,{isOpen:!0,onClose:n,title:null!=o?o:"",closeActionLabel:a("_common_dialog_dismiss_button"),actions:e===l.LastAdmin||l.GroupSharing||l.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),n()}}}:void 0,children:u})};var m=i(837527);const h=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:n}=(0,r.Z)(),{confirmDeleteSubtitle:a,confirmDeleteTitle:o,confirmDeleteDismiss:l,confirmDeleteConfirm:c}=i;return(0,d.tZ)(s.Vq,{title:o,onClose:e,isOpen:!0,dialogClassName:m.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:c,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:l,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:a})},S=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:c,onDeletionSuccess:m,sharingStatus:S,translations:g,vaultItemType:_,isShared:p,isSharedViaUserGroup:b,isItemInCollection:C,isLastAdmin:I})=>{const{showToast:D}=(0,s.pm)(),{translate:A}=(0,r.Z)(),{deleteVaultItems:y}=(0,n.u)(o.L);if(!i)return null;let T;return(p||S?.isShared)&&(b&&(T=l.GroupSharing),I&&(T=l.LastAdmin),C&&(T=l.CollectionSharing)),T&&t?(0,d.tZ)(u,{reason:T,translations:g,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,d.tZ)(h,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await y({ids:[c],vaultItemType:_})).tag===a.rq.Success?(D({description:null!=(e=g.deleteSuccessToast)?e:A("webapp_personal_info_edition_delete_success_toast")}),m()):D({description:A("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){D({description:A("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:g})}},64676:(e,t,i)=>{i.r(t),i.d(t,{SecureNotesEdit:()=>x});var s=i(696832),n=i(15192),a=i(799852),o=i(133354),r=i(970433),l=i(339431),c=i(692077),d=i(37336),u=i(995445),m=i(261582),h=i(713252),S=i(482598),g=i(521877),_=i(514900),p=i(287279),b=i(740300),C=i(488203),I=i(45272),D=i(806697),A=i(86498),y=i(63520),T=i(682994),f=i(86541),w=i(632870),v=i(557634),L=i(99822),N=i(830894),E=i(773157),Z=i(899193),F=i(671785),U=i(420684),G=i(979808),V=i(301639),O=i(285163),q=i(995727),P=i(528835);const{CONTENT:k,DOCUMENT_STORAGE:R,MORE_OPTIONS:M,SHARED_ACCESS:H}=f.SecureNoteTabs,B=(0,N.DP)((({note:e,isShared:t,isAdmin:i,isSharedViaUserGroup:n,isLastAdmin:a,onClose:d})=>{var u,m;const{translate:h}=(0,C.Z)(),{routes:N}=(0,c.Xo)(),B=(0,c.TH)(),X=(0,F.aV)(),{updateVaultItem:x}=(0,S.u)(r.L),{showAlert:z}=(0,A.V)(),{shouldShowFrozenStateDialog:Q}=(0,D.Ub)(),{addNoteToCollections:W}=(0,O.Q)(),{allCollections:K}=(0,q.b)(),[Y,$]=(0,s.useState)(k),[j,J]=(0,s.useState)(!1),[ee]=(0,s.useState)(null),[te,ie]=(0,s.useState)(!1),[se,ne]=(0,s.useState)(!1),[ae,oe]=(0,s.useState)(!1),[re,le]=(0,s.useState)(!1),[ce,de]=(0,s.useState)(e.isSecured),[ue,me]=(0,s.useState)(e.content),[he,Se]=(0,s.useState)(e.title),[ge,_e]=(0,s.useState)(e.color),[pe,be]=(0,s.useState)(e.spaceId),[Ce,Ie]=(0,s.useState)([]),[De,Ae]=(0,s.useState)(!1),{data:ye,status:Te}=(0,G.r)(e.id),fe=()=>z(h("_common_generic_error"),_.BLW.ERROR),we=()=>{(0,U.P)(),B.pathname.includes(N.userSecureNotes)&&(0,I.Nc)(g.PageView.ItemSecureNoteList),d()},ve=async(t=!0)=>{oe(!0);const i=null!=ee?ee:{spaceId:pe,type:ge,category:e.categoryId,secured:ce};try{var s;const t=await x({vaultItemType:l.U.SecureNote,content:{content:ue,title:he,id:e.id,attachments:[...null!=(s=e.attachments)?s:[]],...i},id:e.id});W(e.id,Ce),(0,p.hx)(t)&&fe()}catch(e){fe()}oe(!1),t?we():J(!1)},Le=()=>{le(!0)},Ne=async t=>{le(!1),t.success&&(await b.C.commitSecureFile({secureFileInfo:t.secureFileInfo}),e.attachments?.push((0,Z.w)(t.secureFileInfo)),ve(!1))},Ee=()=>J(!0),Ze=K.filter((t=>t.vaultItems.some((t=>t.id===e.id)))),Fe=Ze.length||Ce.length,Ue=!!e.attachments&&e.attachments.length>0,Ge=!Fe&&(X||Ue),Ve=[k];t?Ve.push(H):Ge&&Ve.push(R);const Oe={confirmDeleteConfirm:h("webapp_secure_notes_edition_delete_confirm"),confirmDeleteDismiss:h("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:h("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:h("webapp_secure_notes_edition_delete_title"),lastAdminActionLabel:h("webapp_credential_edition_change_permissions"),lastAdminTitle:h("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:h("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:h("webapp_secure_notes_edition_group_sharing_title"),groupSharingSubtitle:h("webapp_credential_edition_group_sharing_subtitle"),collectionSharingTitle:h("webapp_credential_edition_collection_sharing_title"),collectionSharingSubtitle:h("webapp_credential_edition_collection_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"},qe={attachments:null!=(u=e.attachments)?u:[],category:e.categoryId?e.categoryId:"noCategory",content:e.content,id:e.id,limitedPermissions:t&&!i,secured:e.isSecured,spaceId:e.spaceId,title:e.title,type:e.color},Pe=e=>t=>{Ee(),e(t)},ke=Pe(be),Re=Pe(_e),Me=Pe(Se),He=Pe(me),Be=Pe(de),Xe=t&&Te===o.rq.Success&&null!=(xe=ye?.count)?xe:0;var xe;const ze=Ze.filter((e=>e.isShared)).length>0;return(0,P.BX)(y.zI,{isViewingExistingItem:!0,itemHasBeenEdited:j,onSubmit:()=>{ve()},isUsingNewDesign:!0,submitPending:ae,secondaryActions:(()=>{switch(Y){case k:return[(n=e,!n||t&&!i||n.attachments?.length?null:(0,P.tZ)(V.Z,{tooltipPlacement:"top-start",sharing:(s=e.id,(0,L.A1)(s)),text:h("webapp_sharing_invite_share"),origin:g.Origin.ItemDetailView},"shareaction"))];case R:return[(0,P.tZ)(E.d,{isQuotaReached:!1,onFileUploadStarted:Le,onFileUploadDone:Ne,isShared:t,itemId:e.id,dataType:"KWSecureNote",disabled:!!Q},"uploadAction")];default:return[]}var s,n})(),onNavigateOut:we,onClickDelete:()=>ie(!0),ignoreCloseOnEscape:te||se,isSomeDialogOpen:te||De,formId:"edit_securenote_panel",header:(0,P.tZ)(w.h,{backgroundColor:qe.type,displayDocumentStorage:Ve.includes(R),displaySharedAccess:Ve.includes(H),displayMoreOptions:Ve.includes(M),recipientsCount:Xe,attachmentsCount:null!=(m=e?.attachments?.length)?m:0,setActiveTab:$,disabled:t&&!i,title:he,setTitle:Me}),children:[(0,P.tZ)(v.T,{activeTab:Y,data:qe,content:null!=ue?ue:"",title:he,color:ge,spaceId:pe,isDisabled:!!Q,isSecured:ce,setSpaceId:ke,setColor:Re,setTitle:Me,setContent:He,setIsSecured:Be,handleFileInfoDetached:t=>{e.attachments=e.attachments?.filter((e=>e.id!==t)),ve(!1)},hasAttachment:Ue,isAdmin:i,isSecureNoteAttachmentEnabled:X,isShared:t,isUploading:re,onModifyData:Ee,onModalDisplayStateChange:ne,setCollectionsToUpdate:Ie,setHasDialogsOpenedByChildren:Ae}),(0,P.tZ)(T.s,{isVisible:te,itemId:e.id,closeConfirmDeleteDialog:()=>ie(!1),goToSharingAccess:()=>{$(f.SecureNoteTabs.SHARED_ACCESS)},onDeletionSuccess:async()=>{e.attachments?.forEach((async e=>{const{id:t}=e;await b.C.deleteSecureFile({id:t})})),we()},isLastAdmin:a,isShared:t,isSharedViaUserGroup:n,isItemInCollection:ze,translations:Oe,vaultItemType:l.U.SecureNote})]})})),X=({note:e,onClose:t})=>{const{getPermissionForItem:i,getSharingStatusForItem:s,getIsLastAdminForItem:n}=(0,u.Y)(m.X,{getPermissionForItem:{queryParam:{itemId:e.id}},getSharingStatusForItem:{queryParam:{itemId:e.id}},getIsLastAdminForItem:{queryParam:{itemId:e.id}}},[]);if(i.status!==o.rq.Success||s.status!==o.rq.Success||n.status!==o.rq.Success)return null;const{isShared:a,isSharedViaUserGroup:r}=s.data,{permission:l}=i.data,{isLastAdmin:c}=n.data,d=a&&l===h.y3.Admin;return(0,P.tZ)(B,{onClose:t,note:e,isShared:a,isAdmin:d,isSharedViaUserGroup:r,isLastAdmin:c})},x=e=>{const t=(0,a.k)(r.L,"query",{vaultItemTypes:[l.U.SecureNote],ids:[`{${e.match.params.uuid}}`]}),{routes:i}=(0,c.Xo)();return t.status===o.rq.Loading?null:t.data?.secureNotesResult.items.length?(0,P.tZ)(X,{...e,note:t.data.secureNotesResult.items[0]}):e.location?.state?(0,P.tZ)(n.l_,{to:(0,d.rF)(e.location?.state,i)}):(0,P.tZ)(n.l_,{to:i.userSecureNotes})}}}]);