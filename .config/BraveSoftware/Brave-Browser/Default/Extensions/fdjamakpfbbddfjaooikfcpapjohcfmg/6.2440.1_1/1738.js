"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[1738],{48094:(e,a,t)=>{t.d(a,{D:()=>l});var n=t(78971),o=t(96832),i=t(44110);const l=(0,o.forwardRef)((({label:e,name:a,value:t,placeholder:l,options:c,disabled:_,dataName:r="localeFormat",onChange:d},u)=>{const p=(0,o.useMemo)((()=>c.map((e=>(0,i.tZ)(n.$m,{value:e.value,children:e.label},e.value)))),[c]);return(0,i.tZ)(n.mg,{ref:u,name:a,label:e,placeholder:l,"data-name":r,value:t,onChange:d,readOnly:_,children:p},"country")}));l.displayName="CountryField"},31738:(e,a,t)=>{t.r(a),t.d(a,{BankAccountAddView:()=>A});var n=t(96832),o=t(82598),i=t(87279),l=t(91871),c=t(44105),_=t(39431),r=t(14900),d=t(50756),u=t(86498),p=t(76376),s=t(39649),m=t(49023),b=t(88203),I=t(45272),y=t(92077),C=t(6697),B=t(63520),h=t(8940),f=t(60062),k=t(99852),w=t(93314);var v,g=t(44110);const N="_common_generic_error",A=({lee:e})=>{var a;const[t,A]=(0,n.useState)(!1),[E,S]=(0,n.useState)(!1),[P,L]=(0,n.useState)(new Set),D=(0,n.useRef)(null),{createVaultItem:R}=(0,o.u)(l.L),{routes:O}=(0,p.Xo)(),{openDialog:V,shouldShowFrozenStateDialog:Z}=(0,C.Ub)();(0,n.useEffect)((()=>{(0,I.Nc)(d.PageView.ItemBankStatementCreate);const e=setTimeout((()=>{D.current?.focus()}),m.sc);return()=>clearTimeout(e)}),[]),(0,n.useEffect)((()=>{Z&&V()}),[Z]);const[U,F]=(0,n.useState)({bankCode:"",country:c.c[e.globalState.locale.country]||c.c.US,IBAN:"",BIC:"",accountName:"",ownerName:"",spaceId:null!=(a=(0,s.B)(e.globalState))?a:""}),x=(e=>{const{data:a}=(0,k.k)(l.L,"query",{vaultItemTypes:[_.U.Identity],propertyFilters:null!==e?[{property:"spaceId",value:e}]:void 0,propertySorting:{property:"lastUse",direction:w.S.Descend}});return a&&a.identitiesResult.matchCount?(e=>{var a;const{firstName:t,lastName:n}=null!=(a=e.filter(Boolean).find((e=>""!==e.firstName.trim()||""!==e.lastName.trim())))?a:{firstName:"",lastName:""};return[t,n].join(" ").trim()})(a.identitiesResult.items):""})(U.spaceId),H=""!==x;(0,n.useEffect)((()=>{""!==x&&F((e=>({...e,owner:x})))}),[H]);const{translate:T}=(0,b.Z)(),{showAlert:z}=(0,u.V)(),q=()=>{(0,I.Nc)(d.PageView.ItemPaymentList),(0,y.uX)(O.userPayments)},M=(0,n.useCallback)(((e,a=!1)=>{F((a=>({...a,...e}))),a||A(!0)}),[]);return(0,g.tZ)(B.zI,{isUsingNewDesign:!0,isViewingExistingItem:!1,itemHasBeenEdited:t,formId:"bank-account-add-form",onNavigateOut:q,onSubmit:async()=>{if(E)return;const e=(0,h.e)(U);if(!e.isValid)return L(e.errorSet);S(!0);try{const e=await R({vaultItemType:_.U.BankAccount,content:U});(0,i.d6)(e)?(z(U.accountName?T("webapp_payment_edition_bank_account_name_save_alert",{accountName:U.accountName}):T("webapp_payment_edition_bank_account_generic_save_alert"),r.BLW.SUCCESS),q()):(z(T(N),r.BLW.ERROR),S(!1))}catch(e){z(T(N),r.BLW.ERROR),S(!1)}},header:(0,g.tZ)(B.V9,{icon:v||(v=(0,g.tZ)(f.L,{})),iconBackgroundColor:r.colors.dashGreen06,title:T("webapp_payment_edition_header_add_bank_account")}),children:(0,g.tZ)(h.o,{bankAccount:U,errors:P,ref:D,onValueChanged:M,variant:"add"})})}},8940:(e,a,t)=>{t.d(a,{o:()=>V,e:()=>Z});var n=t(96832),o=t(44105),i=t(50756),l=t(78971),c=t(88203),_=t(45272),r=t(6697),d=t(82207),u=t(68819),p=t(67406),s=t(30309);const m="webapp_payment_edition_field_bank_account_BIC",b="webapp_payment_edition_field_bank_account_no_BIC_placeholder",I="webapp_payment_edition_field_bank_account_account_number",y="webapp_payment_edition_field_bank_account_no_account_number_placeholder",C="webapp_payment_alert_bank_account_BIC_copied",B="webapp_payment_alert_bank_account_account_number_copied";var h=t(48038),f=t(5465);const k={},w=e=>e!==k,v=[];var g=t(68037),N=t(48094),A=t(62385),E=t(44110);const S="webapp_payment_edition_field_bank_account_action_hide",P="webapp_payment_edition_field_bank_account_action_show",L="webapp_payment_edition_field_bank_account_country",D="webapp_payment_edition_field_bank_account_bank_name",R=(e,a)=>e.filter((e=>!(o.c[e]===o.c.UNIVERSAL||o.c[e]===o.c.NO_TYPE))).map((e=>({label:a(`country_name_${o.c[e]}`),value:o.c[e]}))).sort(((e,a)=>e.label.localeCompare(a.label))),O=(e,a)=>{const{bankAccount:t,errors:O=new Set,onValueChanged:V}=e,{bankCode:Z,accountName:U,IBAN:F,BIC:x,ownerName:H,spaceId:T,country:z}=t,q=F.length>0,M=x.length>0,[X,W]=(0,n.useState)(!M),[$,j]=(0,n.useState)(!q),{translate:K}=(0,c.Z)(),{shouldShowFrozenStateDialog:G}=(0,r.Ub)(),{logRevealBankAccountField:J}=(0,A.E)(),Q="edit"===e.variant?!e.areProtectedItemsUnlocked:void 0,Y=(e=>{switch(e){case s.cH.MX:return{IBAN:"webapp_payment_edition_field_bank_account_CLABE",BIC:m,IBAN_PLACEHOLDER:"webapp_payment_edition_field_bank_account_no_CLABE_placeholder",BIC_PLACEHOLDER:b,IBAN_COPIED:"webapp_payment_alert_bank_account_CLABE_copied",BIC_COPIED:C};case s.cH.GB:return{IBAN:I,BIC:"webapp_payment_edition_field_bank_account_sort_code",IBAN_PLACEHOLDER:y,BIC_PLACEHOLDER:"webapp_payment_edition_field_bank_account_no_sort_code_placeholder",IBAN_COPIED:B,BIC_COPIED:"webapp_payment_alert_bank_account_sort_code_copied"};case s.cH.US:return{IBAN:I,BIC:"webapp_payment_edition_field_bank_account_routing_number",IBAN_PLACEHOLDER:y,BIC_PLACEHOLDER:"webapp_payment_edition_field_bank_account_no_routing_number_placeholder",IBAN_COPIED:B,BIC_COPIED:"webapp_payment_alert_bank_account_routing_number_copied"};default:return{IBAN:"webapp_payment_edition_field_bank_account_IBAN",BIC:m,IBAN_PLACEHOLDER:"webapp_payment_edition_field_bank_account_no_IBAN_placeholder",BIC_PLACEHOLDER:b,IBAN_COPIED:"webapp_payment_alert_bank_account_IBAN_copied",BIC_COPIED:C}}})(z),ee=(0,n.useCallback)((e=>a=>{const t="string"==typeof a?a:a.target.value;V({[e]:t})}),[V]),ae="edit"===e.variant?a=>{(0,_.Kz)(new i.UserRevealVaultItemFieldEvent({field:a,isProtected:!0,itemId:e.itemId,itemType:i.ItemType.BankStatement}))}:void 0,te="edit"===e.variant?(a,t)=>new Promise(((n,o)=>{if(a||e.areProtectedItemsUnlocked)return t(),n();Q&&"function"==typeof e.openProtectedItemsUnlocker&&e.openProtectedItemsUnlocker({action:u.P.Show,itemType:u.R.CreditCard,successCallback:()=>(t(),n()),cancelCallback:o})})):void 0,ne=()=>{!X&&ae&&(ae(i.Field.Bic),J({name:U,field:i.Field.Bic,country:z})),W((e=>!e))},oe=()=>{!$&&ae&&(ae(i.Field.Iban),J({name:U,field:i.Field.Iban,country:z})),j((e=>!e))},ie="edit"===e.variant?a=>{(0,_.Kz)(new i.UserCopyVaultItemFieldEvent({itemType:i.ItemType.BankStatement,field:i.Field.Bic,itemId:e.itemId,isProtected:!0})),a&&e.onCopy(K(Y.BIC_COPIED))}:void 0,le="edit"===e.variant?a=>{(0,_.Kz)(new i.UserCopyVaultItemFieldEvent({itemType:i.ItemType.BankStatement,field:i.Field.Iban,itemId:e.itemId,isProtected:!0})),a&&e.onCopy(K(Y.IBAN_COPIED))}:void 0,ce=(e=>{const a=(()=>{const e=n.useRef(k),a=(0,h.qr)({queryConfig:{query:f.C.getAllBanks}},[]);return w(e.current)||a.status!==h.rq.Success||(e.current=a.data),e.current})();return n.useMemo((()=>{var t;if(!w(a))return v;const n=(null!=(t=a[e])?t:[]).slice();return n.sort(((e,a)=>e.localizedString.localeCompare(a.localizedString))),n}),[a,e])})(z),_e=ce!==v,re=(0,n.useMemo)((()=>ce.map((e=>({label:e.localizedString,value:`${e.code}`})))),[ce]);(0,n.useEffect)((()=>{var e;void 0===(e=Z,re.find((({value:a})=>a===e)))&&re.length>0&&V({bankCode:re[0].value},!0),""!==Z&&!re.length&&_e&&V({bankCode:""})}),[Z,t,re,_e,V]);const de=(0,n.useMemo)((()=>{const e=Object.keys(o.c);return(0,E.tZ)(N.D,{label:K(L),placeholder:K(L)+z,disabled:!!G,options:R(e,K),value:z,onChange:ee("country")})}),[z,ee,G,K]),ue=(0,n.useMemo)((()=>re.length>0?(0,E.tZ)(l.mg,{label:K(D),placeholder:K(D)+Z,onChange:ee("bankCode"),value:Z,readOnly:!!G,children:re.map((e=>(0,E.tZ)(l.$m,{value:e.value,children:e.label},e.value)))},`${z}bank`):null),[Z,re,z,ee,G,K]);return(0,E.BX)("div",{sx:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,E.BX)(g.u,{title:K("webapp_payment_edition_content_bank_details_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,E.tZ)(l.qo,{value:H,label:K("webapp_payment_edition_field_bank_account_owner_name"),placeholder:K("webapp_payment_edition_field_bank_account_no_owner_name_placeholder"),onChange:ee("ownerName"),disabled:!!G,ref:a},"owner"),(0,E.tZ)(l.Nc,{required:!0,label:K(Y.IBAN),placeholder:K(Y.IBAN_PLACEHOLDER),"data-name":"IBAN",readOnly:!$&&q||!!G,isValueInitiallyVisible:$,toggleVisibilityLabel:{hide:K(S),show:K(P)},onValueVisibilityChangeRequest:te?()=>te?.($,oe):void 0,actions:le&&void 0!==Q?[(0,E.tZ)(d.m,{data:F,checkProtected:()=>Q,onCopy:le,itemType:u.R.BankAccount},"copy-iban")]:void 0,value:$?F:"●●●●●●●●●●●●●●●●",onChange:ee("IBAN"),error:O.has("IBAN")},"IBAN"),(0,E.tZ)(l.Nc,{readOnly:!X&&M||!!G,value:X?x:"●●●●●●",label:K(Y.BIC),placeholder:K(Y.BIC_PLACEHOLDER),isValueInitiallyVisible:X,toggleVisibilityLabel:{hide:K(S),show:K(P)},onValueVisibilityChangeRequest:te?()=>te?.(X,ne):void 0,actions:ie&&void 0!==Q?[(0,E.tZ)(d.m,{data:x,checkProtected:()=>Q,onCopy:ie,itemType:u.R.BankAccount},"copy-bic")]:void 0,onChange:ee("BIC"),error:O.has("BIC")},"BIC"),de,ue]}),(0,E.BX)(g.u,{title:K("webapp_payment_edition_content_bank_organization_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,E.tZ)(l.qo,{value:U,label:K("webapp_payment_edition_field_bank_account_name"),placeholder:K("webapp_payment_edition_field_bank_account_no_name_placeholder"),onChange:ee("accountName"),disabled:!!G},"name"),(0,E.tZ)(p.M,{isUsingNewDesign:!0,spaceId:null!=T?T:"",labelSx:p.e,onChange:e=>ee("spaceId")(e),disabled:!!G})]})]})},V=(0,n.forwardRef)(O),Z=e=>e.IBAN&&0!==e.IBAN.length?{isValid:!0}:{isValid:!1,errorSet:new Set(["IBAN"])}},60062:(e,a,t)=>{t.d(a,{L:()=>i}),t(96832);var n=t(14900);var o=t(44110);const i=()=>(0,o.tZ)("div",{className:"iconWrapper--JneIZUVWyv",children:(0,o.tZ)(n.QCj,{size:48,color:n.colors.white})})}}]);