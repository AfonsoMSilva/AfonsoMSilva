"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[3698],{87122:(e,t,i)=>{i.r(t),i.d(t,{CredentialEditPanel:()=>Ne});var n=i(15192),a=i(99852),s=i(95445),r=i(33354),l=i(91871),o=i(39431),d=i(92018),c=i(13252),p=i(27100),u=i(50094),_=i(18108),m=i(66424),h=i(92077),g=i(26356),b=i(30894),S=i(96832),k=i(26849),w=i(30309),x=i(82598),C=i(55989),y=i(14900),f=i(46525),I=i(86342),v=i(86498),D=i(88203),Z=i(6697),L=i(73875),A=i(63520),E=i(82994),P=i(33659),T=i(62042),U=i(99822),B=i(84885),R=i(55449),q=i(10291),V=i(98149),N=i(13134);let z=function(e){return e[e.SHARED_ACCESS=0]="SHARED_ACCESS",e[e.ACCOUNT_DETAILS=1]="ACCOUNT_DETAILS",e[e.LINKED_WEBSITES=2]="LINKED_WEBSITES",e[e.OTP_SETUP=3]="OTP_SETUP",e}({});const W={"account-details":z.ACCOUNT_DETAILS,"shared-access":z.SHARED_ACCESS,"linked-websites":z.LINKED_WEBSITES},O=(e,t)=>{var i;const n=t.find((e=>"accepted"===e.status&&e.info?.forcedDomainsEnabled));return n&&((e,t)=>{var i,n,a;let s="";var r;e.URL&&(s=null!=(r=new N.Y(e.URL).getRootDomain()?.toLowerCase())?r:"");const l=null!=(i=e.email?.toLowerCase())?i:"",o=null!=(n=e.username?.toLowerCase())?n:"",d=null!=(a=e.alternativeUsername?.toLowerCase())?a:"",c=e.linkedURLs.map((e=>e.toLowerCase()));return t.some((e=>{const t=e.toLowerCase();return s.includes(t)||l.includes(t)||o.includes(t)||d.includes(t)||c.some((e=>e.includes(t)))}))})(e,null!=(i=n.info?.teamDomains)?i:[])?n:null};var X,G=i(17534),F=i(78971),M=i(84985),H=i(68037),K=i(44110);const j=({credential:e,onClose:t,openWithNewUrlField:i,onUpdateLinkedWebsitesAddedByUser:n,hasLimitedRights:a,dashlaneDefinedLinkedWebsites:s})=>{const{translate:r}=(0,D.Z)(),[l,o]=S.useState(e.linkedURLs),[d,c]=S.useState(i);return S.useEffect((()=>{const t=e.linkedURLs,i=!(t.length===l.length&&t.every(((e,t)=>l[t]===e)));c(i),n(l)}),[l]),(0,K.BX)("div",{"data-testid":"linked-websites-tab",children:[(0,K.tZ)(F.zx,{"data-testid":"back-button",layout:"iconLeading",mood:"neutral",intensity:"supershy",onClick:t,icon:X||(X=(0,K.tZ)(F.JO,{name:"ArrowLeftOutlined"})),children:r("webapp_credential_linked_websites_title")}),(0,K.tZ)(H.u,{title:r("webapp_credential_linked_websites_section_primary"),description:r("webapp_credential_linked_websites_section_primary_description"),additionalSx:{marginTop:"24px"},children:(0,K.tZ)(M.a,{linkedWebsitesList:[e.URL],areItemsLocked:a,credentialId:e.id,isEditing:!1})}),(0,K.tZ)(H.u,{title:r("webapp_credential_linked_websites_section_added_by_user"),additionalSx:{marginTop:"16px"},children:(0,K.tZ)(M.a,{linkedWebsitesList:l,areItemsLocked:a,credentialId:e.id,isListEditable:!a,isEditing:d,showUrlProtocol:!0,updateLinkedWebsitesList:o})}),s&&s.length>1?(0,K.tZ)(H.u,{title:r("webapp_credential_linked_websites_section_added_by_dashlane"),description:r("webapp_credential_linked_websites_section_added_by_dashlane_description"),additionalSx:{marginTop:"16px"},children:(0,K.tZ)(M.a,{linkedWebsitesList:s,areItemsLocked:!0,credentialId:e.id,isEditing:!1})}):null]})},Y=S.memo(j),J=({onClose:e,setDisplayLinkedWebsitesDataSavedAlert:t})=>{const{translate:i}=(0,D.Z)();return(0,S.useRef)(null).current=window.setTimeout((()=>t(!1)),5e3),(0,K.tZ)(y.YcA,{children:(0,K.tZ)(y.bZj,{size:y.k3y.SMALL,severity:y.BLW.SUCCESS,closeIconName:i("_common_alert_dismiss_button"),onClose:e,children:i("_common_toast_changes_saved")})})};var $=i(17676);const Q=({onCancel:e,onLeavePageWithoutSaving:t})=>{const{translate:i}=(0,D.Z)();return(0,K.tZ)($.o,{isOpen:!0,showCloseIcon:!0,title:i("webapp_credential_linked_websites_discard_dialog_title"),onRequestClose:e,footer:(0,K.BX)(F.kC,{justifyContent:"end",gap:"8px",children:[(0,K.tZ)(y.zxk,{type:"button",nature:"secondary",onClick:e,children:i("webapp_credential_linked_websites_discard_dialog_cancel")}),(0,K.tZ)(y.zxk,{type:"button",onClick:t,children:i("webapp_credential_linked_websites_discard_dialog_discard")})]}),children:(0,K.tZ)(F.kC,{flexDirection:"column",gap:"8px",sx:{width:"576px"},children:(0,K.tZ)(y.nvN,{children:i.markup("webapp_credential_linked_websites_discard_dialog_description_markup")})})})},ee=({duplicateData:e,onCancel:t,onSave:i})=>{const{translate:n}=(0,D.Z)(),a=e.length>1,s=a?n("webapp_credential_linked_websites_duplicate_prevention_dialog_title_multiple"):n("webapp_credential_linked_websites_duplicate_prevention_dialog_title_one",{url:e[0].linkedWebsite}),r=a?n("webapp_credential_linked_websites_duplicate_prevention_dialog_description_multiple"):n("webapp_credential_linked_websites_duplicate_prevention_dialog_description_one",{credentialName:e[0].credentialName}),l=n(a?"webapp_credential_linked_websites_duplicate_prevention_dialog_add_websites_multiple":"webapp_credential_linked_websites_duplicate_prevention_dialog_add_websites_one");return(0,K.tZ)($.o,{isOpen:!0,showCloseIcon:!0,title:s,onRequestClose:t,footer:(0,K.BX)(F.kC,{justifyContent:"end",gap:"8px",children:[(0,K.tZ)(y.zxk,{type:"button",nature:"secondary",onClick:t,children:n("webapp_credential_linked_websites_duplicate_prevention_dialog_cancel")}),(0,K.tZ)(y.zxk,{type:"button",onClick:i,children:l})]}),children:(0,K.BX)("div",{children:[(0,K.tZ)("p",{children:r}),a?(0,K.tZ)("ul",{className:"duplicatesList--SwGmL5ftwe",children:e.map((e=>(0,K.tZ)("li",{className:"duplicateItem--mPX5urdfL2",children:e.linkedWebsite},e.linkedWebsite)))}):null]})})};var te=i(5465);const ie="webapp_password_history_detailed_password_view_button",ne=({credentialId:e})=>{const{translate:t}=(0,D.Z)(),{routes:i}=(0,h.Xo)(),n=i.userPasswordHistoryFilteredByCredential(e),[a,s]=(0,S.useState)(!1);return(0,S.useEffect)((()=>{te.C.getHasPasswordHistory(e).then((e=>{e&&s(!0)}))}),[e]),a?(0,K.tZ)("div",{children:(0,K.tZ)(h.rU,{to:n,tabIndex:-1,children:(0,K.tZ)(F.zx,{mood:"neutral",intensity:"supershy",title:t(ie),icon:"HistoryBackupOutlined",layout:"iconLeading",children:t(ie)})})}):null};var ae=i(72133),se=i(24058),re=i(48467),le=i(71738),oe=i(39632);const de={exit:"exit--p4spwlkedE",exitActive:"exitActive--BIpaDF7MkX",exitDone:"exitDone--KzowOK4h4K",appear:"appear--OcvlWdq5He",appearActive:"appearActive--HVwCcEJzKz",appearDone:"appearDone--KgBJPzbyTA"},ce=({onPrimaryClick:e})=>{const{translate:t}=(0,D.Z)(),[i,n]=S.useState(!1);return(0,K.tZ)(oe.Z,{appear:!0,in:!i,timeout:600,classNames:de,onExited:e,children:(0,K.tZ)("div",{sx:{backgroundColor:"ds.background.default",marginBottom:"24px"},children:(0,K.tZ)(F.ke,{title:t("webapp_credential_edition_health_box_excluded_title"),description:t("webapp_credential_edition_health_box_excluded_description"),mood:"warning",size:"large",actions:[(0,K.tZ)(F.zx,{mood:"brand",intensity:"quiet",onClick:e=>{e.preventDefault(),n(!0)},size:"small",type:"button",children:t("webapp_credential_edition_health_box_include")},"primaryAction")]})})})},pe=S.memo(ce);var ue=i(20987),_e=i(65580);const me={appear:"appear--MMCjEcRU3u",appearActive:"appearActive--LG103cUrNZ",appearDone:"appearDone--tuYaN3WTGO"},he=({onPrimaryClick:e,onSecondaryClick:t,isLimitedSharingPassword:i,corruptionData:n})=>{const{translate:a}=(0,D.Z)();if(!n)return null;const s=((e,t)=>{const{riskType:i}=e;switch(i){case ue.gI.Compromised:return{title:t("webapp_credential_edition_health_box_compromised_title"),description:t("webapp_credential_edition_health_box_compromised_description"),secondary:t("webapp_credential_edition_health_box_view_compromised")};case ue.gI.Reused:return{title:t("webapp_credential_edition_health_box_reused_title"),description:t.markup("webapp_credential_edition_health_box_reused_description_markup",{count:e.reuseCount}),secondary:t("webapp_credential_edition_health_box_view_reused")};case ue.gI.Weak:return{title:t("webapp_credential_edition_health_box_weak_title"),description:t("webapp_credential_edition_health_box_weak_description"),secondary:t("webapp_credential_edition_health_box_view_weak")};default:return(0,_e.U)(i)}})(n,a),r=n.severity===ue.bp.STRONG?"warning":"brand";return(0,K.tZ)(oe.Z,{in:!0,appear:!0,timeout:600,classNames:me,children:(0,K.tZ)("div",{sx:{position:"relative",backgroundColor:"ds.background.default",marginBottom:"24px"},children:(0,K.tZ)(F.ke,{title:s.title,description:s.description,mood:r,size:"large",actions:[(0,K.tZ)(F.zx,{onClick:t,intensity:"quiet",size:"small",children:s.secondary},"view_health"),(0,K.tZ)(y.ua7,{passThrough:!i,content:a("webapp_credential_edition_health_box_change_limited"),placement:"left",sx:{maxWidth:"312px",fontSize:2},children:(0,K.tZ)(F.zx,{size:"small",onClick:e,disabled:i,children:a("webapp_credential_edition_health_box_change_password")})},"change_password")]})})})},ge=S.memo(he),be=JSON.parse('{"v":"5.7.0","fr":30,"ip":0,"op":26,"w":240,"h":240,"nm":"Loading Light Theme","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":3,"nm":"Null 4","sr":1,"ks":{"o":{"a":0,"k":0,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[120,122,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"load","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[0,151,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[250,250,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[88,88],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.05490196078,0.2078431373,0.2392156863,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":6,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0.5,-60.5],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.167],"y":[0.167]},"t":0,"s":[10]},{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.333],"y":[0]},"t":12.5,"s":[42]},{"t":25,"s":[10]}],"ix":2},"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.2],"y":[0]},"t":0,"s":[-19]},{"t":25,"s":[341]}],"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false}],"ip":0,"op":106.197876042479,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"load 2","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[0,151,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[250,250,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[88,88],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.9058823529,0.9215686275,0.9254901961,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":6,"ix":5},"lc":2,"lj":1,"ml":4,"bm":0,"nm":".","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0.5,-60.5],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":106.197876042479,"st":0,"bm":0}],"markers":[]}'),Se=({credentialId:e,isShared:t,hasLimitedPermission:i})=>{const n=(0,h.k6)(),{routes:s}=(0,h.Xo)(),{updateIsCredentialExcluded:r}=(0,se.$)(),{healthData:l}=(e=>{const{data:t}=(0,a.k)(re.d,"credentialHealthData",{credentialId:e});return{healthData:t}})(e),[o,d]=(0,S.useState)(null);return null===l?null:l?(0,K.BX)("div",{sx:{position:"relative"},children:[o?(0,K.tZ)(le.R,{credentialId:o,dismissCallback:()=>d(null)}):null,l.excluded?(0,K.tZ)(pe,{onPrimaryClick:()=>{r(e,!1)}}):(0,K.tZ)(ge,{onPrimaryClick:t=>{t.preventDefault(),d(e)},onSecondaryClick:e=>{e.preventDefault(),n.push(s.userPasswordHealth)},isLimitedSharingPassword:t&&i,corruptionData:l.corruptionData})]}):(0,K.tZ)("div",{sx:{marginBottom:"24px"},children:(0,K.tZ)("div",{sx:{display:"flex",justifyContent:"center"},children:(0,K.tZ)(ae.Z,{height:24,width:24,animationParams:{renderer:"svg",loop:!0,autoplay:!0,animationData:be}})})})};var ke=i(85473),we=i(26555),xe=i(79808);const{SHARED_ACCESS:Ce,ACCOUNT_DETAILS:ye}=z,fe=({credential:e,displayTabs:t,changeTab:i,currentTab:n})=>{const{translate:a}=(0,D.Z)(),{data:s,status:l}=(0,xe.r)(e.id),o=l===r.rq.Success?s?.count:0,d={[ye]:0,[Ce]:1},c=[{id:"tab-credential-detail",contentId:"content-credential-detail",title:a("webapp_credential_edition_account_details"),onSelect:()=>i(ye)},{id:"tab-credential-shared-access",contentId:"content-credential-shared-access",title:`${a("webapp_credential_edition_shared_access")} (${o})`,onSelect:()=>i(Ce)}];return(0,K.tZ)(A.V9,{icon:(0,K.tZ)(we.h,{title:e.itemName,size:ke.o.LARGE,domain:new N.Y(e.URL).getRootDomain()}),title:e.itemName,tabIndex:void 0!==n?d[n]:void 0,tabs:t?Object.values(c):void 0})};var Ie=i(45636),ve=i(46478),De=i(97855);const Ze=({rank:e,content:t,title:i})=>(0,K.BX)(y.T5p,{as:"li",gap:"16px",gridTemplateColumns:"35px 1fr",alignItems:"center",justifyContent:"flex-start",sx:{width:"100%",padding:"6px 0"},children:[(0,K.tZ)(y.dDn,{alignSelf:"flex-start",children:(0,K.tZ)(De.m,{rank:e})}),(0,K.BX)(y.dDn,{children:[(0,K.tZ)(F.nv,{sx:{a:{color:"ds.text.brand.standard"},"a:hover":{color:"ds.text.brand.standard",textDecoration:"underline"}},color:"ds.text.neutral.catchy",textStyle:"ds.title.block.medium",children:i}),t?(0,K.tZ)(F.nv,{color:"ds.text.neutral.quiet",textStyle:"ds.body.standard.regular",children:t}):null]})]});var Le;const Ae=({credentialId:e,title:t,url:i,setHasDataBeenModified:n,onClose:a,onSubmit:s})=>{const{translate:l}=(0,D.Z)(),[o,d]=(0,S.useState)(""),c=(0,Ie.v6)(o),{setupOtpCode:p}=(()=>{const{setupOtpCodeForCredential:e}=(0,x.u)(ve.i);return{setupOtpCode:async(t,i)=>{try{return await e({credentialId:t,otpUrl:i}),!0}catch{return!1}}}})(),{showToast:u}=(0,F.pm)(),_=!!o&&c.status===r.rq.Error,m=c.status!==r.rq.Success;return(0,K.BX)("div",{"data-testid":"linked-websites-tab",children:[(0,K.tZ)(F.zx,{"data-testid":"back-button",layout:"iconLeading",mood:"neutral",intensity:"supershy",size:"large",onClick:a,icon:Le||(Le=(0,K.tZ)(F.JO,{name:"ArrowLeftOutlined"})),children:(0,K.tZ)(F.nv,{textStyle:"ds.title.section.medium",color:"ds.text.neutral.catchy",children:l("webapp_credential_otp_setup_sublevel_header")})}),(0,K.BX)(H.u,{additionalSx:{marginTop:"16px"},children:[(0,K.BX)(F.kC,{as:"ol",gap:"16px",children:[(0,K.tZ)(F.X6,{as:"h3",textStyle:"ds.title.supporting.small",color:"ds.text.neutral.quiet",children:l("webapp_credential_otp_setup_title")}),(0,K.tZ)(Ze,{rank:1,content:l("webapp_credential_otp_setup_step1_description"),title:l.markup("webapp_credential_otp_setup_step1_title_markup",{title:t,url:i},{linkTarget:"_blank"})},"2fa-settings"),(0,K.tZ)(Ze,{rank:2,content:l("webapp_credential_otp_setup_step2_description"),title:l("webapp_credential_otp_setup_step2_title")},"2fa-turn-on"),(0,K.tZ)(Ze,{rank:3,content:l("webapp_credential_otp_setup_step3_description"),title:l("webapp_credential_otp_setup_step3_title")},"enter-setup-code")]}),(0,K.BX)(F.kC,{sx:{mt:"16px",backgroundColor:"ds.container.agnostic.neutral.quiet",padding:"16px",borderRadius:"8px"},gap:"8px",flexDirection:"column",children:[(0,K.tZ)(F.Kx,{error:_,feedback:_?l("webapp_credential_otp_setup_incorrect_setup_code_error"):"",label:l("webapp_credential_otp_setup_code_label"),onChange:e=>{e.preventDefault(),e.stopPropagation(),n(!0),d(e.target.value)}}),(0,K.tZ)(F.zx,{fullsize:!0,onClick:async()=>{c.status===r.rq.Success&&(await p(e,c.data.url)?(s(),u({description:l("webapp_credential_otp_code_success_toast")})):u({mood:"danger",description:l("_common_generic_error")}))},disabled:m,tooltip:l("webapp_credential_otp_setup_submit_button_disabled_tooltip"),children:l("webapp_credential_otp_setup_submit_button")})]})]}),(0,K.tZ)(F.ke,{sx:{mt:"16px"},title:l("webapp_credential_otp_code_cant_find_code_title"),description:l("webapp_credential_otp_code_cant_find_code_description")})]})},Ee=()=>{const{translate:e}=(0,D.Z)();return(0,K.tZ)("div",{sx:{position:"relative",backgroundColor:"ds.background.default",marginBottom:"24px"},children:(0,K.tZ)(F.ke,{title:e("webapp_credential_edition_frozen_limited_rights_title"),description:e("webapp_credential_edition_frozen_limited_rights_description"),mood:"warning",size:"medium"})})};var Pe;const{SHARED_ACCESS:Te,ACCOUNT_DETAILS:Ue,LINKED_WEBSITES:Be,OTP_SETUP:Re}=z,qe=({location:e,activeSpaces:t,credential:i,credentialPreferences:n,onClose:a,protectedItemsUnlockerShown:s,dashlaneDefinedLinkedWebsites:r,areProtectedItemsUnlocked:d,openProtectedItemsUnlocker:_,isShared:m,isAdmin:g,isSharedViaUserGroup:b,isItemInCollection:N,isLastAdmin:z})=>{const{translate:X}=(0,D.Z)(),{routes:F}=(0,h.Xo)(),M=(0,v.V)(),H=(()=>{const{updateLinkedWebsites:e}=(0,x.u)(p.G);return async(t,i)=>{e({credentialId:t,updatedLinkedWebsitesList:i})}})(),{updateVaultItem:j}=(0,x.u)(l.L),{createCollection:$,updateCollection:te}=(0,x.u)(f.v),{addItemsToCollections:ie,removeItemFromCollections:ae}=(0,x.u)(C.a),{updateCredentialPreferences:se}=(0,x.u)(u.I),{shouldShowFrozenStateDialog:re}=(0,Z.Ub)(),le=(0,L.l)(),oe=(0,S.createRef)(),de=()=>{var e,t,a;return{alternativeUsername:null!=(e=i.alternativeUsername)?e:"",email:i.email,itemName:i.itemName,linkedURLs:i.linkedURLs,note:i.note,otpURL:null!=(t=i.otpURL)?t:"",otpSecret:null!=(a=i.otpSecret)?a:"",password:i.password,spaceId:i.spaceId,URL:i.URL,username:i.username,onlyAutofillExactDomain:n.onlyAutofillExactDomain,requireMasterPassword:n.requireMasterPassword,useAutoLogin:n.useAutoLogin}},[ce,pe]=(0,S.useState)(de()),[ue,_e]=(0,S.useState)((()=>{var e;const t=(0,h.CN)();return W[null!=(e=t.get("tab"))?e:"account-details"]})()),[me,he]=(0,S.useState)(Ue),[ge,be]=(0,S.useState)(!1),[ke,we]=(0,S.useState)(!1),[xe,Ce]=(0,S.useState)(i.linkedURLs),[ye,Ie]=(0,S.useState)(!1),[ve,De]=(0,S.useState)(!1),[Ze,Le]=(0,S.useState)([]),[qe,Ve]=(0,S.useState)(!1),[Ne,ze]=(0,S.useState)(!1),[We,Oe]=(0,S.useState)(!1),[Xe,Ge]=(0,S.useState)(!1),[Fe,Me]=(0,S.useState)(!1),[He,Ke]=(0,S.useState)(!1),{current:je}=(0,S.useRef)({confirmDeleteConfirm:X("webapp_credential_edition_delete_confirm"),confirmDeleteDismiss:X("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:X("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:X("webapp_credential_edition_confirm_delete_title"),lastAdminActionLabel:X("webapp_credential_edition_change_permissions"),lastAdminTitle:X("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:X("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:X("webapp_credential_edition_group_sharing_title"),groupSharingSubtitle:X("webapp_credential_edition_group_sharing_subtitle"),collectionSharingTitle:X("webapp_credential_edition_collection_sharing_title"),collectionSharingSubtitle:X("webapp_credential_edition_collection_sharing_subtitle")});if((0,S.useEffect)((()=>{(0,G.SJ)(xe,i.linkedURLs)&&be(!0)}),[xe,i.linkedURLs]),(0,S.useEffect)((()=>{ue===Ue&&pe(de())}),[ue]),(0,S.useEffect)((()=>{const{onlyAutofillExactDomain:e,requireMasterPassword:t,useAutoLogin:i,...n}=ce,{onlyAutofillExactDomain:a,requireMasterPassword:s,useAutoLogin:r,...l}=de(),o=!(0,k.equals)(ce,de());be(o),Ke(!(0,k.equals)(n,l))}),[ce]),null===re||null===le)return null;const Ye=()=>{const e=m&&!g;return{id:i.id,forceCategorizedSpace:O(i,t),isDiscontinuedUser:re,limitedPermissions:e,linkedURLs:i.linkedURLs}},Je=e=>{ge?(he(e),ze(!0)):_e(e)},$e=()=>{ze(!1),Ve(!1),Le([])},Qe=()=>{_e(Ue),be(!1),$e()},et=e=>{e?.preventDefault(),ge?(he(Ue),Ve(!0)):Qe()},tt=()=>{H(i.id,xe),Oe(!0),(0,G.Bq)(i,xe),Qe()},it=e=>!e.initiallyExisting&&!e.hasBeenDeleted,nt=e=>e.initiallyExisting&&!e.hasBeenDeleted,at=()=>{e?.state?.entity?(({routes:e,location:t})=>{t?.state?.entity?(0,B.y)(t?.state?.entity)?(0,h.uX)(e.userSharingGroupInfo(t?.state?.entity?.groupId)):(0,h.uX)(e.userSharingUserInfo(t?.state?.entity?.alias)):(0,h.uX)(e.userSharingCenter)})({routes:F,location:e}):a()},st=()=>{if(ke)return he(Ue),void ze(!0);_e(Ue)},rt=ve||s,lt=le&&Ye().limitedPermissions;return(0,K.BX)(A.zI,{isUsingNewDesign:!0,isViewingExistingItem:!0,itemHasBeenEdited:ge,isSomeDialogOpen:qe||Ze.length>0||Ne||Fe||ve,onSubmit:async()=>{if(ue===Be)return void(async()=>{const e=await(0,G.wb)(i,xe);Le(e),ue!==Be||e.length||tt()})();if(!oe.current?.isFormValid())return;const e=oe.current?.getVaultItemCollections();if(!ge||e){var t;Ge(!0),n&&ce.requireMasterPassword&&ce.requireMasterPassword!==n.requireMasterPassword&&(0,q.ih)(ce.requireMasterPassword,i.id,i.URL,null!=(t=ce.spaceId)?t:void 0);try{const{onlyAutofillExactDomain:t,useAutoLogin:a,requireMasterPassword:s,...r}=ce,l=t!==n.onlyAutofillExactDomain||a!==n.useAutoLogin||s!==n.requireMasterPassword,d=[];He&&d.push(j({vaultItemType:o.U.Credential,content:r,id:i.id,shouldSkipSync:!!l})),l&&d.push(se({credentialId:i.id,credentialUrl:i.URL,onlyAutofillExactDomain:t,useAutoLogin:a,requireMasterPassword:s,shouldSkipSync:e?.some((e=>e.isShared&&!nt(e)))})),e&&d.push((async(e,t,i)=>{const n=[],a=[];for(const r of t){var s;nt(r)||(r.isShared?it(r)?n.push({collectionId:r.id,permission:null!=(s=r.itemPermission)?s:c.y3.Limited}):a.push(r.id):(r.vaultItems=[{id:e,type:w.dJ.KWAuthentifiant,url:i}],r.id?await te({id:r.id,collection:r,operationType:r.hasBeenDeleted?I.C.SUBSTRACT_VAULT_ITEMS:I.C.APPEND_VAULT_ITEMS}):await $({content:r})))}n.length&&await ie({collectionPermissions:n,itemIds:[e],shouldSkipSync:a.length>0}),a.length&&await ae({collectionIds:a,itemId:e})})(i.id,e,i.URL)),await Promise.all(d)}catch(e){return M.showAlert(X("_common_generic_error"),y.BLW.ERROR),void a()}M.showAlert(X("_common_toast_changes_saved"),y.BLW.SUCCESS),a()}},secondaryActions:ue===Be?[]:[(0,K.tZ)(ne,{credentialId:i.id},"pwhist"),(0,K.tZ)(T._,{id:i.id,isShared:m,isAdmin:g,isDiscontinuedUser:re,getSharing:U.Ei},"shareaction")],onNavigateOut:(e,t)=>{ue!==Be?ue!==Re?at():st():et(t)},onClickDelete:()=>De(!0),withoutDeleteButton:ue===Be,withoutConfirmationDialog:ue===Be,withoutCloseButton:ue===Re,ignoreCloseOnEscape:rt,formId:"edit_credential_panel",submitPending:Xe,header:(0,K.tZ)(fe,{credential:i,displayTabs:m,changeTab:Je,currentTab:ue}),children:[m&&ue===Te?(0,K.tZ)("div",{"aria-labelledby":"tab-credential-shared-access",id:"content-credential-shared-access",children:(0,K.tZ)(R.u,{isAdmin:g,id:i.id})}):null,ue===Ue?(0,K.BX)("div",{sx:{flex:1,flexDirection:"column",position:"relative"},"aria-labelledby":"tab-credential-detail",id:"content-credential-detail",children:[lt?Pe||(Pe=(0,K.tZ)(Ee,{})):(0,K.tZ)(Se,{credentialId:i.id,isShared:m,hasLimitedPermission:!g}),(0,K.tZ)("div",{sx:{overflowY:"initial",overflowX:"visible"},children:(0,K.tZ)(V.S,{ref:oe,activeSpaces:t,editableValues:ce,setEditableValues:pe,readonlyValues:Ye(),signalEditedValues:e=>{be(e)},dashlaneDefinedLinkedWebsites:r,areProtectedItemsUnlocked:d,openProtectedItemsUnlocker:_,protectedItemsUnlockerShown:s,onClickAddNewWebsite:()=>(Ie(!0),void Je(Be)),onClickSetup2FAToken:()=>{Je(Re)},setHasOpenedDialogs:Me})})]}):null,ue===Be?(0,K.tZ)(Y,{credential:i,dashlaneDefinedLinkedWebsites:r,onClose:et,openWithNewUrlField:ye,onUpdateLinkedWebsitesAddedByUser:Ce,hasLimitedRights:m&&!g}):null,ue===Re?(0,K.tZ)(Ae,{credentialId:i.id,title:i.itemName,url:i.URL,onClose:st,onSubmit:()=>{we(!1),_e(Ue)},setHasDataBeenModified:we}):null,(0,K.tZ)(E.s,{isVisible:ve,itemId:i.id,closeConfirmDeleteDialog:()=>De(!1),goToSharingAccess:()=>{Je(Te)},onDeletionSuccess:at,isShared:m,isSharedViaUserGroup:b,translations:je,vaultItemType:o.U.Credential,isLastAdmin:z,isItemInCollection:N}),qe?(0,K.tZ)(Q,{onCancel:()=>Ve(!1),onLeavePageWithoutSaving:Qe}):null,Ze.length>0?(0,K.tZ)(ee,{duplicateData:Ze,onCancel:()=>Le([]),onSave:tt}):null,Ne?(0,K.tZ)(P.a,{onDismissClick:()=>ze(!1),onConfirmClick:()=>{_e(me),be(!1),we(!1),$e()}}):null,We?(0,K.tZ)(J,{onClose:()=>Oe(!1),setDisplayLinkedWebsitesDataSavedAlert:Oe}):null]})},Ve=e=>{const{credential:t}=e,i=(0,_.E)(),n=(0,b.tY)(),l=(0,m.B)([t.id]),o=(0,a.k)(p.G,"getDashlaneDefinedLinkedWebsites",{url:t.URL}),h=(0,a.k)(u.I,"getPreferencesForCredentials",{credentialIds:[t.id]}),{getPermissionForItem:g,getSharingStatusForItem:S,getIsLastAdminForItem:k}=(0,s.Y)(d.X,{getPermissionForItem:{queryParam:{itemId:t.id}},getSharingStatusForItem:{queryParam:{itemId:t.id}},getIsLastAdminForItem:{queryParam:{itemId:t.id}}},[]);if(h.status!==r.rq.Success||o.status!==r.rq.Success||g.status!==r.rq.Success||S.status!==r.rq.Success||i.status!==r.rq.Success||k.status!==r.rq.Success)return null;const{isShared:w,isSharedViaUserGroup:x}=S.data,{isLastAdmin:C}=k.data,y=!!l.length;return(0,K.tZ)(qe,{...e,...n,activeSpaces:i.data,dashlaneDefinedLinkedWebsites:o.data,credentialPreferences:h.data[0],isShared:w,isAdmin:w&&g.data.permission===c.y3.Admin,isSharedViaUserGroup:x,isItemInCollection:y,isLastAdmin:C})},Ne=e=>{const{data:t,status:i}=(0,a.k)(l.L,"query",{vaultItemTypes:[o.U.Credential],ids:[`{${e.match.params.uuid}}`]}),{routes:s}=(0,h.Xo)();return i===r.rq.Loading?null:t?.credentialsResult.items.length?(0,K.tZ)(Ve,{...e,credential:t.credentialsResult.items[0]}):e.location?.state?(0,K.tZ)(n.l_,{to:(0,g.rF)(e.location?.state,s)}):(0,K.tZ)(n.l_,{to:s.userCredentials})}},82994:(e,t,i)=>{i.d(t,{s:()=>m}),i(96832);var n=i(78971),a=i(82598),s=i(33354),r=i(91871),l=i(88203);let o=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var d=i(65580),c=i(44110);const p=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:a})=>{const{translate:s}=(0,l.Z)(),r=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:n,collectionSharingTitle:a,genericErrorTitle:s}=e;switch(t){case o.LastAdmin:return n;case o.GroupSharing:return i;case o.CollectionSharing:return a;case o.Generic:return s;default:return(0,d.U)(t)}})(t,e),p=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:n,collectionSharingSubtitle:a,genericErrorSubtitle:s}=e;switch(t){case o.LastAdmin:return n;case o.GroupSharing:return i;case o.CollectionSharing:return a;case o.Generic:return s;default:return(0,d.U)(t)}})(t,e);return(0,c.tZ)(n.Vq,{isOpen:!0,onClose:a,title:null!=r?r:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===o.LastAdmin||o.GroupSharing||o.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),a()}}}:void 0,children:p})};var u=i(37527);const _=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:a}=(0,l.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:r,confirmDeleteDismiss:o,confirmDeleteConfirm:d}=i;return(0,c.tZ)(n.Vq,{title:r,onClose:e,isOpen:!0,dialogClassName:u.Ht,closeActionLabel:a("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:d,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:o,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},m=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:d,onDeletionSuccess:u,sharingStatus:m,translations:h,vaultItemType:g,isShared:b,isSharedViaUserGroup:S,isItemInCollection:k,isLastAdmin:w})=>{const{showToast:x}=(0,n.pm)(),{translate:C}=(0,l.Z)(),{deleteVaultItems:y}=(0,a.u)(r.L);if(!i)return null;let f;return(b||m?.isShared)&&(S&&(f=o.GroupSharing),w&&(f=o.LastAdmin),k&&(f=o.CollectionSharing)),f&&t?(0,c.tZ)(p,{reason:f,translations:h,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,c.tZ)(_,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await y({ids:[d],vaultItemType:g})).tag===s.rq.Success?(x({description:null!=(e=h.deleteSuccessToast)?e:C("webapp_personal_info_edition_delete_success_toast")}),u()):x({description:C("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){x({description:C("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:h})}},62042:(e,t,i)=>{i.d(t,{_:()=>o});var n=i(50756),a=i(88203),s=i(1639),r=i(44110);const l=({sharing:e})=>{const{translate:t}=(0,a.Z)();return(0,r.tZ)(s.Z,{tooltipPlacement:"top-start",sharing:e,text:t("webapp_sharing_invite_share"),origin:n.Origin.ItemDetailView})},o=({id:e,isShared:t,isAdmin:i,isDiscontinuedUser:n,getSharing:a})=>t&&!i||n?null:(0,r.tZ)(l,{sharing:a(e)})},79808:(e,t,i)=>{i.d(t,{r:()=>s});var n=i(99852),a=i(92018);const s=e=>(0,n.k)(a.X,"sharedAccessForItem",{itemId:e})},55449:(e,t,i)=>{i.d(t,{u:()=>L});var n,a,s=i(96832),r=i(14900),l=i(82598),o=i(33354),d=i(55989),c=i(92018),p=i(13252),u=i(87279),_=i(88203),m=i(43194),h=i(61832),g=i(78971),b=i(32814),S=i(4967),k=i(73670),w=i(89572),x=i(58037),C=i(44110);const y=({cancelStatus:e,vaultItemId:t,setCancelStatus:i,recipientId:d})=>{const{translate:u}=(0,_.Z)(),m=e===h.V.Loading,b={type:p.IP.User,alias:d},{revokeSharedItem:S}=(0,l.u)(c.X);(0,s.useEffect)((()=>{let t;return e===h.V.Failure&&(t=window.setTimeout((()=>i(null)),2e3)),()=>{clearTimeout(t)}}),[e,i]);const k=e?()=>i(null):()=>i(h.V.Confirm);return e===h.V.Failure?(0,C.BX)("div",{sx:{color:"ds.text.danger.standard",display:"flex",alignItems:"center"},children:[n||(n=(0,C.tZ)(r.aNP,{color:"ds.text.danger.standard"})),"Â ",u("webapp_shared_access_cancel_failure")]}):(0,C.BX)("div",{children:[(0,C.tZ)(g.zx,{intensity:e?"quiet":"supershy",disabled:m,onClick:k,size:"small",children:u(e?"webapp_shared_access_cancel":"webapp_shared_access_cancel_invitation")}),e?(0,C.tZ)(g.zx,{mood:"danger",intensity:"catchy",sx:{ml:"16px"},disabled:m,size:"small",onClick:()=>(async()=>{i(h.V.Loading);const e=await(async()=>{try{return(await S({vaultItemId:t,recipient:b})).tag===o.rq.Success}catch(e){return!1}})();i(e?h.V.Success:h.V.Failure)})(),children:m?a||(a=(0,C.tZ)(r.HoD,{})):u("webapp_shared_access_confirm")}):null]})};var f;const I=({vaultItemId:e,onUserSelected:t,openEditPermissionsDialog:i,member:n,isAdmin:a})=>{const[r,l]=(0,s.useState)(null),o=(0,x.j)()?.login,{translate:d}=(0,_.Z)();if(r===h.V.Success)return null;const{permission:c,status:u,recipientType:m}=n,I=o===n.recipientId,v=a&&o!==n.recipientId,D="pending"===u?(0,C.tZ)(y,{recipientId:n.recipientId,vaultItemId:e,cancelStatus:r,setCancelStatus:l}):(0,C.tZ)(k.M,{disabled:!a,icon:"ActionEditOutlined",layout:"iconLeading",intensity:"supershy",onClick:()=>{t&&t(n.recipientId),i(n,c,m)},content:d("webapp_sharing_collection_access_description_tooltip"),tooltipSx:{textWrap:"wrap",maxWidth:"240px"},size:"small",children:d("webapp_shared_access_edit_permissions")});return(0,C.tZ)("li",{sx:{alignItems:"center",display:"flex",minHeight:"48px",position:"relative"},children:(0,C.tZ)(S.r,{infoAction:v?D:null,logo:n.recipientType===p.IP.Group?f||(f=(0,C.tZ)(w.Z,{})):(0,C.tZ)(b.q,{email:n.recipientName,size:36}),title:n.recipientName,permissionBadge:(0,C.tZ)(g.Ct,{mood:"admin"===c?"brand":"danger",label:d("admin"===c?"webapp_sharing_permissions_full_rights":"webapp_sharing_permissions_limited_rights")}),disabled:r===h.V.Loading,titleLogo:I?(0,C.tZ)(g.Ct,{label:d("webapp_shared_access_you_badge").toUpperCase(),layout:"labelOnly",sx:{marginLeft:"4px"}}):null})},n.recipientId)};var v=i(79808),D=i(68037),Z=i(14341);const L=({id:e,isAdmin:t})=>{const{translate:i}=(0,_.Z)(),[n,a]=(0,s.useState)(!1),[g,b]=(0,s.useState)(null),[S,k]=(0,s.useState)(void 0),{data:w,status:x}=(0,v.r)(e),{updatePermissionForCollectionItem:y,removeItemFromCollections:f}=(0,l.u)(d.a),{revokeSharedItem:L,updateSharedItemPermission:A}=(0,l.u)(c.X);if(x!==o.rq.Success)return(0,C.tZ)(r.HoD,{color:"ds.container.expressive.brand.catchy.idle",size:50,sx:{alignSelf:"center",m:"20px"}});if(!w)return null;const{users:E,groups:P,collections:T}=w,U=e=>{g&&b({...g,step:e})},B=async()=>{if(!g)return;const{recipient:t,permission:i,recipientType:n}=g;a(!0);const s="revoke"===i?await(async(t,i)=>{try{if(i===p.IP.Collection){const i=await f({collectionIds:[t.recipientId],itemId:e});return!!(0,u.d6)(i)}return(await L({vaultItemId:e,recipient:(0,Z.d)(t)})).tag===o.rq.Success}catch(e){return!1}})(t,n):await(async(t,i,n)=>{try{if(n===p.IP.Collection){const n=await y({itemId:e,collection:{collectionId:t.recipientId,permission:i}});return!!(0,u.d6)(n)}return(await A({vaultItemId:e,recipient:(0,Z.d)(t),permission:i})).tag===o.rq.Success}catch(e){return!1}})(t,i,n);if(s){const e="revoke"===i?h.PermissionDialogStep.RevokeSuccess:h.PermissionDialogStep.Success;U(e)}else U(h.PermissionDialogStep.Failure);a(!1)},R=(e,t,i)=>{const n={recipient:e,recipientType:i,permission:t,originPermission:t,step:h.PermissionDialogStep.Permission,name:e.recipientName};b(n)},q=P?.length>0,V=T?.length>0,N=E?.length>0,z=!(S&&E.find((e=>e.recipientId!==S&&e.permission===p.y3.Admin)))&&g?.recipient.recipientType===p.IP.User,W="collection"===g?.recipientType;return(0,C.BX)("div",{sx:{flex:"1",overflowY:"auto"},children:[(0,C.BX)("ul",{sx:{flex:"1"},children:[V?(0,C.tZ)(D.u,{title:i("webapp_shared_access_collections"),additionalSx:{marginBottom:"16px"},children:T.map((i=>(0,C.tZ)(I,{isAdmin:t,member:i,vaultItemId:e,openEditPermissionsDialog:R},i.recipientId)))}):null,q?(0,C.tZ)(D.u,{title:i("webapp_shared_access_groups_card_title"),additionalSx:{marginBottom:"16px"},children:P.map((i=>(0,C.tZ)(I,{isAdmin:t,member:i,vaultItemId:e,openEditPermissionsDialog:R},i.recipientId)))}):null,N?(0,C.tZ)(D.u,{title:i("webapp_shared_access_individuals_card_title"),children:E.map((i=>(0,C.tZ)(I,{isAdmin:t,member:i,onUserSelected:e=>k(e),vaultItemId:e,openEditPermissionsDialog:R},i.recipientId)))}):null]}),g&&(0,C.tZ)(m.E,{isOpen:!0,isCollectionItemPermission:W,shouldRevokeBeDisabled:z||void 0,loading:n,onCancelRevoke:()=>{g&&b({...g,step:h.PermissionDialogStep.Permission})},onConfirmRevoke:B,onDismiss:()=>b(null),onSelectPermission:e=>{g&&b({...g,permission:e})},onValidatePermission:()=>{"revoke"===g?.permission?b({...g,step:h.PermissionDialogStep.ConfirmRevoke}):B()},permission:g.permission,recipient:g.recipient,step:g.step})]})}}}]);