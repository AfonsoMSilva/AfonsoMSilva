"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[5559],{5559:(e,t,a)=>{a.r(t),a.d(t,{SecretAddPanelComponent:()=>D});var n=a(96832),s=a(42714),c=a(82598),i=a(33354),l=a(91871),r=a(39431),d=a(14900),o=a(86498),p=a(88203),u=a(14943),_=a(63520),h=a(15940),b=a(19122),m=a(66098),S=a(78047),g=a(92077),I=a(45272),C=a(50756),f=a(5465),w=a(99193),y=a(73157),T=a(6697),v=a(44110);const{CONTENT:x,DOCUMENT_STORAGE:E}=h.SecretsTabs,D=()=>{const{routes:e}=(0,g.Xo)(),t=(0,u.Y)(),[a,h]=(0,n.useState)(x),[D,O]=(0,n.useState)(!1),[Z,A]=(0,n.useState)(!1),[N,U]=(0,n.useState)(!1),{currentSpaceId:R,teamId:P}=(0,b.fV)(),F=(0,s.o)("ace_secrets_vault_attachment"),[k,B]=(0,n.useState)({id:"",limitedPermissions:!1,title:"",content:"",spaceId:null!=R?R:P?String(P):"",secured:!1,attachments:[]}),{shouldShowFrozenStateDialog:V}=(0,T.Ub)(),{createVaultItem:z}=(0,c.u)(l.L),L=(0,o.V)(),{translate:M}=(0,p.Z)();if((0,n.useEffect)((()=>{(0,I.Nc)(C.PageView.ItemSecretCreate)}),[]),t.status!==i.rq.Success||!t?.data)return null;const H=()=>(0,g.uX)(e.userSecrets),X=F?[{id:"tab-secret-detail",contentId:"content-secret-detail",title:M("webapp_secrets_edition_field_tab_title_details"),onSelect:()=>h(x)},{id:"tab-secret-attachments",contentId:"content-secret-attachments",title:M("webapp_secrets_edition_field_tab_title_attachments"),onSelect:()=>h(E)}]:void 0;return(0,v.tZ)(_.zI,{isUsingNewDesign:!0,isViewingExistingItem:!1,itemHasBeenEdited:D,submitPending:Z,onSubmit:async()=>{Z||(A(!0),await(async()=>{try{var e;await z({vaultItemType:r.U.Secret,content:{title:k.title,content:k.content,spaceId:null!=(e=k.spaceId)?e:"",isSecured:k.secured,attachments:k.attachments}})}catch(e){A(!1),L.showAlert(M("_common_generic_error"),d.BLW.ERROR)}})(),H())},onNavigateOut:()=>{H()},formId:"add_secret_panel",header:(0,v.tZ)(m.h,{title:k.title?k.title:M("webapp_secrets_title_field"),tabs:X}),secondaryActions:a===E?[(0,v.tZ)(y.d,{isQuotaReached:!1,onFileUploadStarted:()=>{U(!0)},onFileUploadDone:async e=>{U(!1),e.success&&(await f.C.commitSecureFile({secureFileInfo:e.secureFileInfo}),B((t=>({...t,attachments:[...t.attachments,(0,w.w)(e.secureFileInfo)]}))),O(!0))},isShared:!1,dataType:"KWSecret",disabled:!!V},"uploadAction")]:[],children:(0,v.tZ)(S.e,{activeTab:a,isAdmin:!1,isSecured:k.secured,secretValues:k,handleChange:(e,t)=>{if("spaceId"===e&&t===k.spaceId)return;const a={...k,[e]:t},n=!!(a.title||a.content||a.spaceId||a.secured);n!==D&&O(n),B(a)},handleFileInfoDetached:e=>{B((t=>({...t,attachments:t.attachments.filter((t=>t.id!==e))})))},isAttachmentUploading:N,isNewItem:!0})})}},15940:(e,t,a)=>{a.d(t,{SecretsTabs:()=>n});let n=function(e){return e[e.CONTENT=0]="CONTENT",e[e.SHARED_ACCESS=1]="SHARED_ACCESS",e[e.DOCUMENT_STORAGE=2]="DOCUMENT_STORAGE",e}({})},66098:(e,t,a)=>{a.d(t,{h:()=>l});var n,s=a(78971),c=a(63520),i=a(44110);const l=({title:e,tabs:t})=>(0,i.tZ)(c.V9,{icon:(0,i.tZ)("div",{sx:{width:"168px",height:"108px",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",borderColor:"ds.border.neutral.quiet.idle",display:"flex",justifyContent:"center",alignItems:"center"},children:n||(n=(0,i.tZ)(s.JO,{name:"ItemSecretOutlined",color:"ds.text.neutral.standard",size:"xlarge"}))}),title:e,tabs:t})},78047:(e,t,a)=>{a.d(t,{e:()=>O});var n=a(96832),s=a(78971),c=a(33354),i=a(80936),l=a(88203),r=a(55449),d=a(33988),o=a(54350),p=a(68037),u=a(67406),_=a(15940),h=a(6697),b=a(61014),m=a(50756),S=a(30894),g=a(68819),I=a(82207),C=a(45272),f=a(44110);const{CONTENT:w,SHARED_ACCESS:y,DOCUMENT_STORAGE:T}=_.SecretsTabs,v="webapp_secure_notes_edition_field_text_max_size_reached",x="webapp_secret_edition_action_show_secret_content",E="webapp_secret_edition_action_hide_secret_content",D=1e4,O=({activeTab:e,isAdmin:t,isSecured:a,isAttachmentUploading:_,isNewItem:O,secretValues:Z,handleChange:A,handleFileInfoDetached:N,onModalDisplayStateChange:U})=>{const{translate:R}=(0,l.Z)(),[P,F]=(0,n.useState)(""),{shouldShowFrozenStateDialog:k}=(0,h.Ub)(),B=(0,d.F)(),{isMPLessUser:V}=(0,o.Z)(),z=!B&&!V,{areProtectedItemsUnlocked:L,openProtectedItemsUnlocker:M}=(0,S.tY)(),H=(0,i.I)(),X=H.status===c.rq.Success&&!H.isDisabled,{id:q,limitedPermissions:G,title:K,content:W,spaceId:Y,secured:j}=Z,[J,Q]=(0,n.useState)(""===W),$=a&&!L,ee=Boolean(W.length),te=(0,n.useCallback)(((e,t)=>new Promise(((a,n)=>{if(e||!$)return t(),a();M({action:g.P.Show,itemType:g.R.Secret,successCallback:()=>(t(),a()),cancelCallback:n})}))),[$,M]),ae=()=>Q((e=>!e));return null===k?null:(0,f.BX)(f.HY,{children:[e===w&&(0,f.BX)("div",{"aria-labelledby":"tab-secret-detail",id:"content-secret-detail",children:[(0,f.BX)(p.u,{title:R("webapp_secrets_box_title_details"),children:[(0,f.tZ)(s.qo,{"data-name":"title",label:R("webapp_secrets_title_field"),value:K,onChange:e=>A("title",e.target.value),disabled:G,readOnly:k,sx:{marginBottom:"8px"}}),(0,f.tZ)(s.Kx,{"data-name":"content",label:R("webapp_secrets_content_field"),placeholder:R("webapp_secrets_content_field_placeholder"),value:J||!ee?W:"••••••••",onBeforeInput:e=>{const t=e.currentTarget.value;t.length>D&&(F(R(v,{charLeft:D-(t.length-1)})),e.preventDefault())},onPaste:e=>{const t=e.clipboardData.getData("text/plain");e.currentTarget.value.length+t.length>D&&(F(R(v,{charLeft:D-e.currentTarget.value.length})),e.preventDefault())},onChange:e=>{P&&F(""),A("content",e.target.value)},disabled:G,readOnly:!J&&ee||k,feedback:P?{text:P}:void 0,error:!!P,actions:[(0,f.tZ)(s.zx,{layout:"iconOnly",icon:J?"ActionHideOutlined":"ActionRevealOutlined",mood:"brand",intensity:"supershy",sx:{marginRight:"16px"},onClick:()=>{te(J,ae).catch((()=>{Q(!1)}))},"aria-label":R(J?E:x),tooltip:R(J?E:x)},"secret-content-visibility"),...ee?[(0,f.tZ)(I.m,{data:W,checkProtected:()=>$,copyLabel:R("webapp_secret_edition_action_copy_secret_content"),onCopy:()=>{(0,C.Kz)(new m.UserCopyVaultItemFieldEvent({itemId:q,itemType:m.ItemType.Secret,field:m.Field.Secret,isProtected:a}))},itemType:g.R.Secret,tooltipLocation:"right"},"copy-secret-content")]:[]]})]}),X?(0,f.tZ)(u.M,{disabled:k,contentCardLabel:R("webapp_secrets_box_title_organization"),wrapInContentCard:!0,isUsingNewDesign:!0,defaultSpaceId:null!=Y?Y:"",spaceId:null!=Y?Y:"",onChange:e=>A("spaceId",e)}):null,z?(0,f.tZ)(p.u,{title:R("webapp_secrets_box_title_preferences"),additionalSx:{marginTop:"16px"},children:(0,f.tZ)(s.XZ,{readOnly:k,label:R("webapp_secrets_preferences_mp_title"),description:R("webapp_secrets_preferences_mp_description"),checked:Boolean(j),onChange:()=>{L||O?A("secured",Boolean(!j)):((0,S.jF)(),M({action:g.P.Show,itemType:g.R.Secret,successCallback:()=>A("secured",Boolean(!j))}))}})}):null]}),e===T&&(0,f.tZ)("div",{"aria-labelledby":"tab-secret-attachments",id:"content-secret-attachments",children:(0,f.tZ)(b.P,{attachments:Z.attachments,additionalProps:{itemId:q,itemType:m.ItemType.Secret,handleFileInfoDetached:e=>{N(e)},onModalDisplayStateChange:U,isUploading:_}})}),e===y&&(0,f.tZ)("div",{"aria-labelledby":"tab-secret-shared-access",id:"content-secret-shared-access",children:(0,f.tZ)(r.u,{isAdmin:t,id:q})})]})}}}]);