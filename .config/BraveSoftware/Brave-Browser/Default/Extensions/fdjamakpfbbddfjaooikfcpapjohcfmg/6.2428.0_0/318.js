"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[318],{766490:(e,t,a)=>{a.r(t),a.d(t,{NoteAddPanel:()=>Z});var s=a(696832),o=a(133354),n=a(521877),c=a(148038),i=a(482598),l=a(287279),r=a(514900),u=a(970433),d=a(339431),S=a(45272),p=a(692077),h=a(740300),m=a(108403),g=a(114943),y=a(806697),I=a(276376),N=a(557634),f=a(63520),b=a(86541),C=a(899193),T=a(773157),w=a(420684),A=a(671785),E=a(413368),D=a(632870),v=a(619122),_=a(86498),F=a(488203),O=a(285163),P=a(528835);const{CONTENT:U,DOCUMENT_STORAGE:R}=b.SecureNoteTabs,V=({activeSpaces:e})=>{var t;const{routes:a}=(0,I.Xo)(),o=(0,A.aV)(),b=(0,g.Y)(),{openPaywall:V}=(0,m.nL)(),k=(0,p.k6)(),{openDialog:Z,shouldShowFrozenStateDialog:L}=(0,y.Ub)(),[q,B]=(0,s.useState)(U),[G,M]=(0,s.useState)(!1),[Y,z]=(0,s.useState)(!1),[H,Q]=(0,s.useState)([]),{currentSpaceId:W}=(0,v.fV)(),X=(0,_.V)(),{translate:x}=(0,F.Z)(),{addNoteToCollections:K}=(0,O.Q)(),[j,J]=(0,s.useState)(!1),[$,ee]=(0,s.useState)(""),[te,ae]=(0,s.useState)(""),[se,oe]=(0,s.useState)("GRAY"),[ne,ce]=(0,s.useState)(e?.length>0&&!e[0].info?.personalSpaceEnabled?e[0].teamId:null!=W?W:""),[ie,le]=(0,s.useState)(!1),{createVaultItem:re}=(0,i.u)(u.L),[ue,de]=(0,s.useState)([]),[Se,pe]=(0,s.useState)(!1),he={attachments:H.map(C.w),id:"",limitedPermissions:!1,content:$,title:te,category:"noCategory",type:"GRAY",spaceId:ne,secured:!1};if((0,s.useEffect)((()=>{(0,S.Nc)(n.PageView.ItemSecureNoteCreate)}),[]),(0,s.useEffect)((()=>{L&&Z()}),[L]),b.status!==c.rq.Success||!b?.data)return null;const me=(0,E.n6)(E.Co.SecureNotes,b.data?.capabilities),ge=()=>X.showAlert(x("_common_generic_error"),r.BLW.ERROR),ye=()=>{(0,S.Nc)(n.PageView.ItemSecureNoteList),(0,w.P)(),(0,p.uX)(a.userSecureNotes)},Ie=()=>M(!0),Ne=e=>t=>{Ie(),e(t)},fe=Ne(ce),be=Ne(oe),Ce=Ne(ae),Te=Ne(ee),we=Ne(le);return me&&(V(E.qd.SecureNote),k.push("/secure-notes")),(0,P.tZ)(f.zI,{isViewingExistingItem:!1,itemHasBeenEdited:G,submitPending:Y,onSubmit:async()=>{if(!Y){z(!0);try{await(async()=>{const e={spaceId:null!=ne?ne:"",type:se,category:"noCategory",secured:ie};try{const t=await re({vaultItemType:d.U.SecureNote,content:{...e,content:$,title:te,attachments:he.attachments}});if(!(0,l.d6)(t))return void ge();const a=(0,l.db)(t).id;await K(a,ue)}catch(e){ge()}Q([])})()}catch{z(!1)}ye()}},secondaryActions:q===R?[t||(t=(0,P.tZ)(T.d,{isQuotaReached:!1,isShared:!1,onFileUploadStarted:()=>{J(!0)},onFileUploadDone:async e=>{J(!1),e.success&&(await h.C.commitSecureFile({secureFileInfo:e.secureFileInfo}),Q([...H,e.secureFileInfo]),M(!0))},dataType:"KWSecureNote"},"uploadAction"))]:[],primaryActions:[],onNavigateOut:()=>{H.forEach((async e=>{const{Id:t}=e;await h.C.deleteSecureFile({id:t})})),(0,w.P)(),Q([]),ye()},isUsingNewDesign:!0,isSomeDialogOpen:Se,formId:"add_securenote_panel",header:(0,P.tZ)(D.h,{backgroundColor:he.type,displayDocumentStorage:!ue.length,displaySharedAccess:!1,displayMoreOptions:!1,setActiveTab:B,title:te,setTitle:e=>{Ie(),ae(e)}}),children:(0,P.tZ)(N.T,{activeTab:q,data:he,content:$,title:te,color:se,spaceId:null!=ne?ne:"",setSpaceId:fe,setColor:be,setTitle:Ce,setContent:Te,setIsSecured:we,handleFileInfoDetached:e=>{Q(H.filter((t=>t.Id!==e)))},hasAttachment:!!H.length,isSecured:ie,isAdmin:!1,isDisabled:!!L,isSecureNoteAttachmentEnabled:o,isShared:!1,isUploading:j,onModifyData:Ie,setCollectionsToUpdate:de,setHasDialogsOpenedByChildren:pe})})};var k=a(718108);const Z=()=>{const e=(0,k.E)();return e.status!==o.rq.Success?null:(0,P.tZ)(V,{activeSpaces:e.data})}}}]);