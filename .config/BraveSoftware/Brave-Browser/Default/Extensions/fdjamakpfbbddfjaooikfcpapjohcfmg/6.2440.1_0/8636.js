"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[8636],{82994:(e,t,i)=>{i.d(t,{s:()=>p}),i(96832);var a=i(78971),n=i(82598),s=i(33354),r=i(91871),c=i(88203);let l=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var o=i(65580),d=i(44110);const u=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:n})=>{const{translate:s}=(0,c.Z)(),r=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:a,collectionSharingTitle:n,genericErrorTitle:s}=e;switch(t){case l.LastAdmin:return a;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,o.U)(t)}})(t,e),u=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:a,collectionSharingSubtitle:n,genericErrorSubtitle:s}=e;switch(t){case l.LastAdmin:return a;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,o.U)(t)}})(t,e);return(0,d.tZ)(a.Vq,{isOpen:!0,onClose:n,title:null!=r?r:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===l.LastAdmin||l.GroupSharing||l.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),n()}}}:void 0,children:u})};var _=i(37527);const m=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:n}=(0,c.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:r,confirmDeleteDismiss:l,confirmDeleteConfirm:o}=i;return(0,d.tZ)(a.Vq,{title:r,onClose:e,isOpen:!0,dialogClassName:_.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:o,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:l,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},p=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:o,onDeletionSuccess:_,sharingStatus:p,translations:h,vaultItemType:S,isShared:g,isSharedViaUserGroup:b,isItemInCollection:C,isLastAdmin:f})=>{const{showToast:I}=(0,a.pm)(),{translate:D}=(0,c.Z)(),{deleteVaultItems:w}=(0,n.u)(r.L);if(!i)return null;let A;return(g||p?.isShared)&&(b&&(A=l.GroupSharing),f&&(A=l.LastAdmin),C&&(A=l.CollectionSharing)),A&&t?(0,d.tZ)(u,{reason:A,translations:h,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,d.tZ)(m,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await w({ids:[o],vaultItemType:S})).tag===s.rq.Success?(I({description:null!=(e=h.deleteSuccessToast)?e:D("webapp_personal_info_edition_delete_success_toast")}),_()):I({description:D("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){I({description:D("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:h})}},62042:(e,t,i)=>{i.d(t,{_:()=>l});var a=i(50756),n=i(88203),s=i(1639),r=i(44110);const c=({sharing:e})=>{const{translate:t}=(0,n.Z)();return(0,r.tZ)(s.Z,{tooltipPlacement:"top-start",sharing:e,text:t("webapp_sharing_invite_share"),origin:a.Origin.ItemDetailView})},l=({id:e,isShared:t,isAdmin:i,isDiscontinuedUser:a,getSharing:n})=>t&&!i||a?null:(0,r.tZ)(c,{sharing:n(e)})},68636:(e,t,i)=>{i.r(t),i.d(t,{SecretEditPanel:()=>q});var a=i(96832),n=i(15192),s=i(91871),r=i(39431),c=i(95445),l=i(33354),o=i(99852),d=i(92018),u=i(13252),_=i(50756),m=i(30894),p=i(45272),h=i(26356),S=i(92077),g=i(42714),b=i(88203),C=i(15940),f=i(62042),I=i(82994),D=i(63520),w=i(99822),A=i(78047),T=i(66098),y=i(6697),v=i(79808),Z=i(82598),E=i(14900),U=i(86498),L=i(73157),O=i(5465),x=i(99193),F=i(92730),P=i(44110);const{CONTENT:R,SHARED_ACCESS:k,DOCUMENT_STORAGE:G}=C.SecretsTabs,N=({secret:e,isShared:t,isAdmin:i,isSharedViaUserGroup:n,isLastAdmin:c})=>{var o,d,u;const{translate:_}=(0,b.Z)(),{routes:m}=(0,S.Xo)(),{navigateBack:p}=(0,F.u)(),[h,N]=(0,a.useState)(R),[V,q]=(0,a.useState)(!1),[B,M]=(0,a.useState)(!1),[H,z]=(0,a.useState)(!1),[X,Y]=(0,a.useState)(!1),[K,W]=(0,a.useState)(!1),[$,j]=(0,a.useState)({id:e.id,limitedPermissions:t&&!i,title:e.title,content:e.content,spaceId:null!=(o=e.spaceId)?o:"",secured:null!=(d=e.isSecured)&&d,attachments:null!=(u=e.attachments)?u:[]}),{data:J,status:Q}=(0,v.r)(e.id),ee=function(){const{translate:e}=(0,b.Z)(),{showAlert:t}=(0,U.V)(),{updateVaultItem:i}=(0,Z.u)(s.L);return async(a,n)=>{try{await i({vaultItemType:r.U.Secret,content:a,id:n})}catch{t(e("_common_generic_error"),E.BLW.ERROR)}}}(),{shouldShowFrozenStateDialog:te}=(0,y.Ub)(),ie=(0,g.o)("ace_secrets_vault_attachment")||!!e.attachments&&e.attachments.length>0,ae=t&&Q===l.rq.Success&&null!=(ne=J?.count)?ne:0;var ne;const se=()=>{p(m.userSecrets)};if(!e)return se(),null;const re=async(t=!0,i)=>{var a;Y(!0),await ee({title:$.title,content:$.content,spaceId:null!=(a=$.spaceId)?a:"",isSecured:$.secured,attachments:i},e.id),Y(!1),t&&se()},ce=()=>{W(!0)},le=async e=>{if(W(!1),e.success){await O.C.commitSecureFile({secureFileInfo:e.secureFileInfo});const t=[...$.attachments,(0,x.w)(e.secureFileInfo)];j((e=>({...e,attachments:t}))),re(!1,t)}},oe={confirmDeleteConfirm:_("webapp_secrets_edition_delete_confirm"),confirmDeleteDismiss:_("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:_("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:_("webapp_secrets_edition_delete_title"),lastAdminActionLabel:_("webapp_credential_edition_change_permissions"),lastAdminTitle:_("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:_("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:_("webapp_secrets_edition_group_sharing_title"),groupSharingSubtitle:_("webapp_credential_edition_group_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"};if(null===te)return null;const de=t||ie?[{id:"tab-secret-detail",contentId:"content-secret-detail",title:_("webapp_secrets_edition_field_tab_title_details"),onSelect:()=>N(R)}]:[];return t?de.push({id:"tab-secret-shared-access",contentId:"content-secret-shared-access",title:`${_("webapp_secure_notes_edition_field_tab_title_shared_access")} (${ae})`,onSelect:()=>N(k)}):ie&&de.push({id:"tab-secret-attachments",contentId:"content-secret-attachments",title:_("webapp_secrets_edition_field_tab_title_attachments"),onSelect:()=>N(G)}),(0,P.BX)(D.zI,{isUsingNewDesign:!0,isViewingExistingItem:!0,itemHasBeenEdited:V,onSubmit:()=>re(),submitPending:X,secondaryActions:(()=>{switch(h){case R:return[(a=e,!a||t&&!i||a.attachments?.length?null:(0,P.tZ)(f._,{id:e.id,isShared:t,isAdmin:i,isDiscontinuedUser:te,getSharing:w.fl},"shareaction"))];case G:return[(0,P.tZ)(L.d,{isQuotaReached:!1,onFileUploadStarted:ce,onFileUploadDone:le,isShared:t,itemId:e.id,dataType:"KWSecret",disabled:!!te},"uploadAction")];default:return[]}var a})(),onNavigateOut:se,onClickDelete:()=>M(!0),ignoreCloseOnEscape:B||H,isSomeDialogOpen:B,formId:"edit_secret_panel",header:(0,P.tZ)(T.h,{title:$.title,tabs:de}),children:[(0,P.tZ)(A.e,{activeTab:h,isAdmin:i,isSecured:e.isSecured,isAttachmentUploading:K,isNewItem:!1,secretValues:$,handleChange:(t,i)=>{if("spaceId"===t&&i===$.spaceId)return;const a={...$,[t]:i},n=e.title!==a.title||e.content!==a.content||e.spaceId!==a.spaceId||e.isSecured!==a.secured;n!==V&&q(n),j(a)},handleFileInfoDetached:e=>{const t=$.attachments.filter((t=>t.id!==e));j((e=>({...e,attachments:t}))),re(!1,t)},onModalDisplayStateChange:z}),(0,P.tZ)(I.s,{isVisible:B,itemId:e.id,closeConfirmDeleteDialog:()=>M(!1),goToSharingAccess:()=>{N(C.SecretsTabs.SHARED_ACCESS)},onDeletionSuccess:se,translations:oe,vaultItemType:r.U.Secret,isShared:t,isLastAdmin:c,isSharedViaUserGroup:n})]})},V=e=>{const{secret:t}=e,i=(0,m.tY)();(0,a.useEffect)((()=>{(0,p.Nc)(_.PageView.ItemSecretDetails)}),[t]);const{getPermissionForItem:n,getSharingStatusForItem:s,getIsLastAdminForItem:r}=(0,c.Y)(d.X,{getPermissionForItem:{queryParam:{itemId:t.id}},getSharingStatusForItem:{queryParam:{itemId:t.id}},getIsLastAdminForItem:{queryParam:{itemId:t.id}}},[]);if(n.status!==l.rq.Success||s.status!==l.rq.Success||r.status!==l.rq.Success)return null;const{isShared:o,isSharedViaUserGroup:h}=s.data,{isLastAdmin:S}=r.data;return(0,P.tZ)(N,{...e,...i,isShared:o,isAdmin:o&&n.data.permission===u.y3.Admin,isSharedViaUserGroup:h,isLastAdmin:S})},q=e=>{const{routes:t}=(0,S.Xo)(),{data:i,status:a}=(0,o.k)(s.L,"query",{vaultItemTypes:[r.U.Secret],ids:[`{${e.match.params.uuid}}`]});return a===l.rq.Loading?null:i?.secretsResult.items.length?(0,P.tZ)(V,{...e,secret:i.secretsResult.items[0]}):e.location?.state?(0,P.tZ)(n.l_,{to:(0,h.rF)(e.location.state,t)}):(0,P.tZ)(n.l_,{to:t.userSecrets})}},15940:(e,t,i)=>{i.d(t,{SecretsTabs:()=>a});let a=function(e){return e[e.CONTENT=0]="CONTENT",e[e.SHARED_ACCESS=1]="SHARED_ACCESS",e[e.DOCUMENT_STORAGE=2]="DOCUMENT_STORAGE",e}({})},66098:(e,t,i)=>{i.d(t,{h:()=>c});var a,n=i(78971),s=i(63520),r=i(44110);const c=({title:e,tabs:t})=>(0,r.tZ)(s.V9,{icon:(0,r.tZ)("div",{sx:{width:"168px",height:"108px",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",borderColor:"ds.border.neutral.quiet.idle",display:"flex",justifyContent:"center",alignItems:"center"},children:a||(a=(0,r.tZ)(n.JO,{name:"ItemSecretOutlined",color:"ds.text.neutral.standard",size:"xlarge"}))}),title:e,tabs:t})},78047:(e,t,i)=>{i.d(t,{e:()=>E});var a=i(96832),n=i(78971),s=i(33354),r=i(80936),c=i(88203),l=i(55449),o=i(33988),d=i(54350),u=i(68037),_=i(67406),m=i(15940),p=i(6697),h=i(61014),S=i(50756),g=i(30894),b=i(68819),C=i(82207),f=i(45272),I=i(44110);const{CONTENT:D,SHARED_ACCESS:w,DOCUMENT_STORAGE:A}=m.SecretsTabs,T="webapp_secure_notes_edition_field_text_max_size_reached",y="webapp_secret_edition_action_show_secret_content",v="webapp_secret_edition_action_hide_secret_content",Z=1e4,E=({activeTab:e,isAdmin:t,isSecured:i,isAttachmentUploading:m,isNewItem:E,secretValues:U,handleChange:L,handleFileInfoDetached:O,onModalDisplayStateChange:x})=>{const{translate:F}=(0,c.Z)(),[P,R]=(0,a.useState)(""),{shouldShowFrozenStateDialog:k}=(0,p.Ub)(),G=(0,o.F)(),{isMPLessUser:N}=(0,d.Z)(),V=!G&&!N,{areProtectedItemsUnlocked:q,openProtectedItemsUnlocker:B}=(0,g.tY)(),M=(0,r.I)(),H=M.status===s.rq.Success&&!M.isDisabled,{id:z,limitedPermissions:X,title:Y,content:K,spaceId:W,secured:$}=U,[j,J]=(0,a.useState)(""===K),Q=i&&!q,ee=Boolean(K.length),te=(0,a.useCallback)(((e,t)=>new Promise(((i,a)=>{if(e||!Q)return t(),i();B({action:b.P.Show,itemType:b.R.Secret,successCallback:()=>(t(),i()),cancelCallback:a})}))),[Q,B]),ie=()=>J((e=>!e));return null===k?null:(0,I.BX)(I.HY,{children:[e===D&&(0,I.BX)("div",{"aria-labelledby":"tab-secret-detail",id:"content-secret-detail",children:[(0,I.BX)(u.u,{title:F("webapp_secrets_box_title_details"),children:[(0,I.tZ)(n.qo,{"data-name":"title",label:F("webapp_secrets_title_field"),value:Y,onChange:e=>L("title",e.target.value),disabled:X,readOnly:k,sx:{marginBottom:"8px"}}),(0,I.tZ)(n.Kx,{"data-name":"content",label:F("webapp_secrets_content_field"),placeholder:F("webapp_secrets_content_field_placeholder"),value:j||!ee?K:"••••••••",onBeforeInput:e=>{const t=e.currentTarget.value;t.length>Z&&(R(F(T,{charLeft:Z-(t.length-1)})),e.preventDefault())},onPaste:e=>{const t=e.clipboardData.getData("text/plain");e.currentTarget.value.length+t.length>Z&&(R(F(T,{charLeft:Z-e.currentTarget.value.length})),e.preventDefault())},onChange:e=>{P&&R(""),L("content",e.target.value)},disabled:X,readOnly:!j&&ee||k,feedback:P?{text:P}:void 0,error:!!P,actions:[(0,I.tZ)(n.zx,{layout:"iconOnly",icon:j?"ActionHideOutlined":"ActionRevealOutlined",mood:"brand",intensity:"supershy",sx:{marginRight:"16px"},onClick:()=>{te(j,ie).catch((()=>{J(!1)}))},"aria-label":F(j?v:y),tooltip:F(j?v:y)},"secret-content-visibility"),...ee?[(0,I.tZ)(C.m,{data:K,checkProtected:()=>Q,copyLabel:F("webapp_secret_edition_action_copy_secret_content"),onCopy:()=>{(0,f.Kz)(new S.UserCopyVaultItemFieldEvent({itemId:z,itemType:S.ItemType.Secret,field:S.Field.Secret,isProtected:i}))},itemType:b.R.Secret,tooltipLocation:"right"},"copy-secret-content")]:[]]})]}),H?(0,I.tZ)(_.M,{disabled:k,contentCardLabel:F("webapp_secrets_box_title_organization"),wrapInContentCard:!0,isUsingNewDesign:!0,defaultSpaceId:null!=W?W:"",spaceId:null!=W?W:"",onChange:e=>L("spaceId",e)}):null,V?(0,I.tZ)(u.u,{title:F("webapp_secrets_box_title_preferences"),additionalSx:{marginTop:"16px"},children:(0,I.tZ)(n.XZ,{readOnly:k,label:F("webapp_secrets_preferences_mp_title"),description:F("webapp_secrets_preferences_mp_description"),checked:Boolean($),onChange:()=>{q||E?L("secured",Boolean(!$)):((0,g.jF)(),B({action:b.P.Show,itemType:b.R.Secret,successCallback:()=>L("secured",Boolean(!$))}))}})}):null]}),e===A&&(0,I.tZ)("div",{"aria-labelledby":"tab-secret-attachments",id:"content-secret-attachments",children:(0,I.tZ)(h.P,{attachments:U.attachments,additionalProps:{itemId:z,itemType:S.ItemType.Secret,handleFileInfoDetached:e=>{O(e)},onModalDisplayStateChange:x,isUploading:m}})}),e===w&&(0,I.tZ)("div",{"aria-labelledby":"tab-secret-shared-access",id:"content-secret-shared-access",children:(0,I.tZ)(l.u,{isAdmin:t,id:z})})]})}}}]);